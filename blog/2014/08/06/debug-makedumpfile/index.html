
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>makedumpfile.8 - kk Blog —— 通用基础</title>

  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="kk Blog —— 通用基础" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/category.js" type="text/javascript"></script>

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">kk Blog —— 通用基础</a></h1>
  
    <h2>cp -rf * .</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
<li>
<form action="/search" method="get">
    <input class="search" name="query" id="query" type="text" placeholder="search...">
    <input id="btnSubmit" value="search" type="submit">
</form>
<script type="text/javascript">
var query = GetRequest("query");
if (query != null) {
	document.getElementById("query").value = query;
}
</script>
</li>
  <li><a href="/atom.xml" rel="subscribe-rss">RSS</a></li>
  
</ul>
  
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/download">Download</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h2 class="entry-title">makedumpfile.8</h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-06T14:46:00+08:00'><span class='date'>2014-08-06</span> <span class='time'>14:46:00</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><h4>makedumpfile.8</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NAME
</span><span class='line'>
</span><span class='line'>       makedumpfile - make a small dumpfile of kdump
</span><span class='line'>
</span><span class='line'>SYNOPSIS
</span><span class='line'>
</span><span class='line'>       makedumpfile    [OPTION] [-x VMLINUX|-i VMCOREINFO] VMCORE DUMPFILE
</span><span class='line'>       makedumpfile -F [OPTION] [-x VMLINUX|-i VMCOREINFO] VMCORE
</span><span class='line'>       makedumpfile -R DUMPFILE
</span><span class='line'>       makedumpfile   --split   [OPTION]  [-x  VMLINUX|-i  VMCOREINFO]  VMCORE
</span><span class='line'>       DUMPFILE1 DUMPFILE2 [DUMPFILE3 ..]
</span><span class='line'>       makedumpfile --reassemble DUMPFILE1 DUMPFILE2 [DUMPFILE3 ..] DUMPFILE
</span><span class='line'>       makedumpfile -g VMCOREINFO -x VMLINUX
</span><span class='line'>       makedumpfile  -E  [--xen-syms   XEN-SYMS|--xen-vmcoreinfo   VMCOREINFO]
</span><span class='line'>       VMCORE DUMPFILE
</span><span class='line'>       makedumpfile --dump-dmesg [-x VMLINUX|-i VMCOREINFO] VMCORE LOGFILE
</span><span class='line'>       makedumpfile -h
</span><span class='line'>       makedumpfile -v
</span><span class='line'>
</span><span class='line'>DESCRIPTION
</span><span class='line'>
</span><span class='line'>       With  kdump,  the  memory  image  of the first kernel (called "panicked
</span><span class='line'>       kernel") can be taken as /proc/vmcore while the second  kernel  (called
</span><span class='line'>       "kdump   kernel"   or  "capture  kernel")  is  running.  This  document
</span><span class='line'>       represents /proc/vmcore as VMCORE. makedumpfile makes a small  DUMPFILE
</span><span class='line'>       by  compressing  dump  data  or  by  excluding  unnecessary  pages  for
</span><span class='line'>       analysis,  or  both.  makedumpfile  needs  the  first  kernel's   debug
</span><span class='line'>       information,  so that it can distinguish unnecessary pages by analyzing
</span><span class='line'>       how the first kernel uses the memory.  The  information  can  be  taken
</span><span class='line'>       from VMLINUX or VMCOREINFO.
</span><span class='line'>
</span><span class='line'>       makedumpfile  can  exclude  the  following types of pages while copying
</span><span class='line'>       VMCORE to DUMPFILE, and a user can choose which type of pages  will  be
</span><span class='line'>       excluded.
</span><span class='line'>       - Pages filled with zero
</span><span class='line'>       - Cache pages
</span><span class='line'>       - User process data pages
</span><span class='line'>       - Free pages
</span><span class='line'>
</span><span class='line'>       makedumpfile  provides  two  DUMPFILE  formats  (the ELF format and the
</span><span class='line'>       kdump-compressed format). By default, makedumpfile makes a DUMPFILE  in
</span><span class='line'>       the  kdump-compressed  format.  The kdump-compressed format is readable
</span><span class='line'>       only with the crash utility, and it can be smaller than the ELF  format
</span><span class='line'>       because of the compression support. The ELF format is readable with GDB
</span><span class='line'>       and the crash utility.  If a user wants to use GDB, DUMPFILE format has
</span><span class='line'>       to be explicitly specified to be the ELF format.
</span><span class='line'>
</span><span class='line'>       To  analyze  the first kernel's memory usage, makedumpfile can refer to
</span><span class='line'>       VMCOREINFO instead of VMLINUX. VMCOREINFO contains the  first  kernel's
</span><span class='line'>       information  (structure  size,  field  offset, etc.), and VMCOREINFO is
</span><span class='line'>       small enough to be included into the second kernel's initrd.
</span><span class='line'>       If the second kernel is running on its initrd without mounting  a  root
</span><span class='line'>       file  system,  makedumpfile  cannot refer to VMLINUX because the second
</span><span class='line'>       kernel's initrd cannot include a large file like VMLINUX. To solve  the
</span><span class='line'>       problem,  makedumpfile  makes  VMCOREINFO  beforehand, and it refers to
</span><span class='line'>       VMCOREINFO instead of VMLINUX while the second kernel is running.
</span><span class='line'>       VMCORE has contained VMCOREINFO since linux-2.6.24, and a user does not
</span><span class='line'>       need to specify neither -x nor -i option.
</span><span class='line'>
</span><span class='line'>       If the second kernel is running on its initrd without mounting any file
</span><span class='line'>       system, a user needs to transport the dump data to a  remote  host.  To
</span><span class='line'>       transport  the  dump data by SSH, makedumpfile outputs the dump data in
</span><span class='line'>       the intermediate format (the flattened format) to the standard  output.
</span><span class='line'>       By piping the output data to SSH, a user can transport the dump data to
</span><span class='line'>       a remote host. Note that  analysis  tools  cannot  read  the  flattened
</span><span class='line'>       format directly, so on a remote host the received data in the flattened
</span><span class='line'>       format needs  to  be  rearranged  to  a  readable  DUMPFILE  format  by
</span><span class='line'>       makedumpfile (or makedumpfile-R.pl).
</span><span class='line'>
</span><span class='line'>       makedumpfile can read a DUMPFILE in the kdump-compressed format instead
</span><span class='line'>       of VMCORE and re-filter it. This feature is useful  in  situation  that
</span><span class='line'>       users need to reduce the file size of DUMPFILE for sending it somewhere
</span><span class='line'>       by ftp/scp/etc. (If all of the page types, which are specified by a new
</span><span class='line'>       dump_level,  are  excluded  from  an  original  DUMPFILE already, a new
</span><span class='line'>       DUMPFILE is the same as an original DUMPFILE.)
</span><span class='line'>       For example, makedumpfile can create a DUMPFILE of dump_level  31  from
</span><span class='line'>       the one of dump_level 3 like the following:
</span><span class='line'>       Example:
</span><span class='line'>       # makedumpfile -c -d 3 /proc/vmcore dumpfile.1
</span><span class='line'>       # makedumpfile -c -d 31 dumpfile.1 dumpfile.2
</span><span class='line'>
</span><span class='line'>OPTIONS
</span><span class='line'>
</span><span class='line'>       -c     Compress dump data by each page.
</span><span class='line'>              A  user  cannot  specify this option with -E option, because the
</span><span class='line'>              ELF format does not support compressed data.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -c -d 31 -x vmlinux /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>       -d dump_level
</span><span class='line'>              Specify the type of unnecessary page for analysis.
</span><span class='line'>              Pages of the specified type are not copied to DUMPFILE. The page
</span><span class='line'>              type  marked  in  the  following  table  is excluded. A user can
</span><span class='line'>              specify multiple page types by setting the sum of each page type
</span><span class='line'>              for  dump_level.  The  maximum  of dump_level is 31. Note that a
</span><span class='line'>              dump_level for Xen dump filtering is 0 or 1 on a  machine  other
</span><span class='line'>              than  x86_64  (On an x86_64 machine, it is possible to specify 2
</span><span class='line'>              or bigger as a dump_level).
</span><span class='line'>              If specifying  multiple  dump_levels  with  the  delimiter  ',',
</span><span class='line'>              makedumpfile  retries  to  create a DUMPFILE by other dump_level
</span><span class='line'>              when "No  space  on  device"  error  happens.  For  example,  if
</span><span class='line'>              dump_level  is  "11,31" and makedumpfile fails by dump_level 11,
</span><span class='line'>              makedumpfile retries it by dump_level 31.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -d 11 -x vmlinux /proc/vmcore dumpfile
</span><span class='line'>              # makedumpfile -d 11,31 -x vmlinux /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>                dump | zero | cache|cache  | user | free
</span><span class='line'>               level | page | page |private| data | page
</span><span class='line'>              -------+------+------+-------+------+------
</span><span class='line'>                   0 |      |      |       |      |
</span><span class='line'>                   1 |  X   |      |       |      |
</span><span class='line'>                   2 |      |  X   |       |      |
</span><span class='line'>                   3 |  X   |  X   |       |      |
</span><span class='line'>                   4 |      |  X   |  X    |      |
</span><span class='line'>                   5 |  X   |  X   |  X    |      |
</span><span class='line'>                   6 |      |  X   |  X    |      |
</span><span class='line'>                   7 |  X   |  X   |  X    |      |
</span><span class='line'>                   8 |      |      |       |  X   |
</span><span class='line'>                   9 |  X   |      |       |  X   |
</span><span class='line'>                  10 |      |  X   |       |  X   |
</span><span class='line'>                  11 |  X   |  X   |       |  X   |
</span><span class='line'>                  12 |      |  X   |  X    |  X   |
</span><span class='line'>                  13 |  X   |  X   |  X    |  X   |
</span><span class='line'>                  14 |      |  X   |  X    |  X   |
</span><span class='line'>                  15 |  X   |  X   |  X    |  X   |
</span><span class='line'>                  16 |      |      |       |      |  X
</span><span class='line'>                  17 |  X   |      |       |      |  X
</span><span class='line'>                  18 |      |  X   |       |      |  X
</span><span class='line'>                  19 |  X   |  X   |       |      |  X
</span><span class='line'>                  20 |      |  X   |  X    |      |  X
</span><span class='line'>                  21 |  X   |  X   |  X    |      |  X
</span><span class='line'>                  22 |      |  X   |  X    |      |  X
</span><span class='line'>                  23 |  X   |  X   |  X    |      |  X
</span><span class='line'>                  24 |      |      |       |  X   |  X
</span><span class='line'>                  25 |  X   |      |       |  X   |  X
</span><span class='line'>                  26 |      |  X   |       |  X   |  X
</span><span class='line'>                  27 |  X   |  X   |       |  X   |  X
</span><span class='line'>                  28 |      |  X   |  X    |  X   |  X
</span><span class='line'>                  29 |  X   |  X   |  X    |  X   |  X
</span><span class='line'>                  30 |      |  X   |  X    |  X   |  X
</span><span class='line'>                  31 |  X   |  X   |  X    |  X   |  X
</span><span class='line'>
</span><span class='line'>       -E     Create DUMPFILE in the ELF format.
</span><span class='line'>              This option cannot be specified with -c option, because the  ELF
</span><span class='line'>              format does not support compressed data.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -E -d 31 -x vmlinux /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>       -f     Force existing DUMPFILE to be overwritten.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -f -d 31 -x vmlinux /proc/vmcore dumpfile
</span><span class='line'>              This command overwrites DUMPFILE even if it already exists.
</span><span class='line'>
</span><span class='line'>       -x VMLINUX
</span><span class='line'>              Specify  the  first  kernel's  VMLINUX with debug information to
</span><span class='line'>              analyze the first kernel's memory usage.
</span><span class='line'>              This option is necessary if VMCORE does not contain  VMCOREINFO,
</span><span class='line'>              [-i VMCOREINFO] is not specified, and dump_level is 2 or more.
</span><span class='line'>              The  page  size of the first kernel and the second kernel should
</span><span class='line'>              match.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -d 31 -x vmlinux /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>       -i VMCOREINFO
</span><span class='line'>              Specify VMCOREINFO instead of VMLINUX for  analyzing  the  first
</span><span class='line'>              kernel's memory usage.
</span><span class='line'>              VMCOREINFO  should  be  made  beforehand by makedumpfile with -g
</span><span class='line'>              option, and it contains the first kernel's information.
</span><span class='line'>              This option is necessary if VMCORE does not contain  VMCOREINFO,
</span><span class='line'>              [-x VMLINUX] is not specified, and dump_level is 2 or more.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -d 31 -i vmcoreinfo /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>       -g VMCOREINFO
</span><span class='line'>              Generate  VMCOREINFO  from the first kernel's VMLINUX with debug
</span><span class='line'>              information.
</span><span class='line'>              VMCOREINFO must be generated on the system that is  running  the
</span><span class='line'>              first  kernel.  With  -i  option,  a user can specify VMCOREINFO
</span><span class='line'>              generated on the other system that is  running  the  same  first
</span><span class='line'>              kernel. [-x VMLINUX] must be specified.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -g vmcoreinfo -x vmlinux
</span><span class='line'>
</span><span class='line'>       -F     Output  the  dump  data  in the flattened format to the standard
</span><span class='line'>              output for transporting the dump data by SSH.
</span><span class='line'>              Analysis tools cannot read the flattened  format  directly.  For
</span><span class='line'>              analysis,  the  dump  data  in  the  flattened  format should be
</span><span class='line'>              rearranged to a normal DUMPFILE (readable with  analysis  tools)
</span><span class='line'>              by  -R  option. By which option is specified with -F option, the
</span><span class='line'>              format of the rearranged DUMPFILE is fixed.  In other words,  it
</span><span class='line'>              is  impossible to specify the DUMPFILE format when the dump data
</span><span class='line'>              is rearranged with -R option. If specifying -E  option  with  -F
</span><span class='line'>              option, the format of the rearranged DUMPFILE is the ELF format.
</span><span class='line'>              Otherwise, it is the kdump-compressed format. All  the  messages
</span><span class='line'>              are  output  to  standard  error  output  by  -F  option because
</span><span class='line'>              standard output is used for the dump data.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -F -c -d 31 -x vmlinux /proc/vmcore \
</span><span class='line'>              | ssh user@host "cat &gt; dumpfile.tmp"
</span><span class='line'>              # makedumpfile -F -c -d 31 -x vmlinux /proc/vmcore \
</span><span class='line'>              | ssh user@host "makedumpfile -R dumpfile"
</span><span class='line'>              # makedumpfile -F -E -d 31 -i vmcoreinfo  /proc/vmcore \
</span><span class='line'>              | ssh user@host "makedumpfile -R dumpfile"
</span><span class='line'>              # makedumpfile -F -E --xen-vmcoreinfo VMCOREINFO /proc/vmcore \
</span><span class='line'>              | ssh user@host "makedumpfile -R dumpfile"
</span><span class='line'>
</span><span class='line'>       -R     Rearrange the  dump  data  in  the  flattened  format  from  the
</span><span class='line'>              standard  input  to  a  normal  DUMPFILE (readable with analysis
</span><span class='line'>              tools).
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -R dumpfile &lt; dumpfile.tmp
</span><span class='line'>              # makedumpfile -F -d 31 -x vmlinux /proc/vmcore \
</span><span class='line'>              | ssh user@host "makedumpfile -R dumpfile"
</span><span class='line'>
</span><span class='line'>              Instead of using -R option, a  perl  script  "makedumpfile-R.pl"
</span><span class='line'>              rearranges  the  dump  data  in the flattened format to a normal
</span><span class='line'>              DUMPFILE, too. The perl script does not depend on  architecture,
</span><span class='line'>              and  most systems have perl command.  Even if a remote host does
</span><span class='line'>              not have makedumpfile, it is possible to rearrange the dump data
</span><span class='line'>              in  the flattened format to a readable DUMPFILE on a remote host
</span><span class='line'>              by running this script.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -F -d 31 -x vmlinux /proc/vmcore \
</span><span class='line'>              | ssh user@host "makedumpfile-R.pl dumpfile"
</span><span class='line'>
</span><span class='line'>       --split
</span><span class='line'>              Split the dump  data  to  multiple  DUMPFILEs  in  parallel.  If
</span><span class='line'>              specifying  DUMPFILEs on different storage devices, a device can
</span><span class='line'>              share I/O load with other devices and it reduces time for saving
</span><span class='line'>              the  dump  data.  The file size of each DUMPFILE is smaller than
</span><span class='line'>              the system memory  size  which  is  divided  by  the  number  of
</span><span class='line'>              DUMPFILEs.  This  feature  supports  only  the  kdump-compressed
</span><span class='line'>              format.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile --split -d 31 -x vmlinux  /proc/vmcore  dumpfile1
</span><span class='line'>              dumpfile2
</span><span class='line'>
</span><span class='line'>       --reassemble
</span><span class='line'>              Reassemble  multiple  DUMPFILEs,  which  are  created by --split
</span><span class='line'>              option,  into  one  DUMPFILE.  dumpfile1   and   dumpfile2   are
</span><span class='line'>              reassembled into dumpfile on the following example.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile --reassemble dumpfile1 dumpfile2 dumpfile
</span><span class='line'>
</span><span class='line'>       --xen-syms XEN-SYMS
</span><span class='line'>              Specify the XEN-SYMS with debug information to analyze the xen's
</span><span class='line'>              memory  usage.   This  option  extracts  the  part  of  xen  and
</span><span class='line'>              domain-0.  -E option must be specified with this option.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -E --xen-syms xen-syms /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>       --xen-vmcoreinfo VMCOREINFO
</span><span class='line'>              Specify  VMCOREINFO  instead of XEN-SYMS for analyzing the xen's
</span><span class='line'>              memory usage.
</span><span class='line'>              VMCOREINFO should be made beforehand  by  makedumpfile  with  -g
</span><span class='line'>              option,  and  it contains the xen's information.  -E option must
</span><span class='line'>              be specified with this option.
</span><span class='line'>              Example:
</span><span class='line'>              #  makedumpfile  -E  --xen-vmcoreinfo  VMCOREINFO   /proc/vmcore
</span><span class='line'>              dumpfile
</span><span class='line'>
</span><span class='line'>       -X     Exclude  all  the user domain pages from Xen kdump's VMCORE, and
</span><span class='line'>              extracts the part  of  xen  and  domain-0.  If  VMCORE  contains
</span><span class='line'>              VMCOREINFO  for  Xen,  it is not necessary to specify --xen-syms
</span><span class='line'>              and --xen-vmcoreinfo.  -E option must  be  specified  with  this
</span><span class='line'>              option.
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -E -X /proc/vmcore dumpfile
</span><span class='line'>
</span><span class='line'>       --xen_phys_start xen_phys_start_address
</span><span class='line'>              This    option    is    only    for    x86_64.     Specify   the
</span><span class='line'>              xen_phys_start_address, if the xen code/data is relocatable  and
</span><span class='line'>              VMCORE does not contain xen_phys_start_address in the CRASHINFO.
</span><span class='line'>              xen_phys_start_address can be taken from the line of "Hypervisor
</span><span class='line'>              code  and  data" in /proc/iomem. For example, specify 0xcee00000
</span><span class='line'>              as xen_phys_start_address if /proc/iomem is the following:
</span><span class='line'>                -------------------------------------------------------
</span><span class='line'>                # cat /proc/iomem
</span><span class='line'>                ...
</span><span class='line'>                  cee00000-cfd99999 : Hypervisor code and data
</span><span class='line'>                ...
</span><span class='line'>                -------------------------------------------------------
</span><span class='line'>
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile -E -X  --xen_phys_start  0xcee00000  /proc/vmcore
</span><span class='line'>              dumpfile
</span><span class='line'>
</span><span class='line'>       --message-level message_level
</span><span class='line'>              Specify the message types.
</span><span class='line'>              Users  can  restrict outputs printed by specifying message_level
</span><span class='line'>              with this option. The message type  marked  with  an  X  in  the
</span><span class='line'>              following table is printed. For example, according to the table,
</span><span class='line'>              specifying 7 as message_level means progress  indicator,  common
</span><span class='line'>              message,  and  error  message are printed, and this is a default
</span><span class='line'>              value. Note that the maximum value of message_level is 31.
</span><span class='line'>
</span><span class='line'>               message | progress | common  | error   | debug   | report
</span><span class='line'>               level   | indicator| message | message | message | message
</span><span class='line'>              ---------+----------+---------+---------+---------+---------
</span><span class='line'>                     0 |          |         |         |         |
</span><span class='line'>                     1 |    X     |         |         |         |
</span><span class='line'>                     2 |          |    X    |         |         |
</span><span class='line'>                     3 |    X     |    X    |         |         |
</span><span class='line'>                     4 |          |         |    X    |         |
</span><span class='line'>                     5 |    X     |         |    X    |         |
</span><span class='line'>                     6 |          |    X    |    X    |         |
</span><span class='line'>                   * 7 |    X     |    X    |    X    |         |
</span><span class='line'>                     8 |          |         |         |    X    |
</span><span class='line'>                     9 |    X     |         |         |    X    |
</span><span class='line'>                    10 |          |    X    |         |    X    |
</span><span class='line'>                    11 |    X     |    X    |         |    X    |
</span><span class='line'>                    12 |          |         |    X    |    X    |
</span><span class='line'>                    13 |    X     |         |    X    |    X    |
</span><span class='line'>                    14 |          |    X    |    X    |    X    |
</span><span class='line'>                    15 |    X     |    X    |    X    |    X    |
</span><span class='line'>                    16 |          |         |         |         |    X
</span><span class='line'>                    17 |    X     |         |         |         |    X
</span><span class='line'>                    18 |          |    X    |         |         |    X
</span><span class='line'>                    19 |    X     |    X    |         |         |    X
</span><span class='line'>                    20 |          |         |    X    |         |    X
</span><span class='line'>                    21 |    X     |         |    X    |         |    X
</span><span class='line'>                    22 |          |    X    |    X    |         |    X
</span><span class='line'>                    23 |    X     |    X    |    X    |         |    X
</span><span class='line'>                    24 |          |         |         |    X    |    X
</span><span class='line'>                    25 |    X     |         |         |    X    |    X
</span><span class='line'>                    26 |          |    X    |         |    X    |    X
</span><span class='line'>                    27 |    X     |    X    |         |    X    |    X
</span><span class='line'>                    28 |          |         |    X    |    X    |    X
</span><span class='line'>                    29 |    X     |         |    X    |    X    |    X
</span><span class='line'>                    30 |          |    X    |    X    |    X    |    X
</span><span class='line'>                    31 |    X     |    X    |    X    |    X    |    X
</span><span class='line'>
</span><span class='line'>       --vtop virtual_address
</span><span class='line'>              This option is useful, when user debugs the translation  problem
</span><span class='line'>              of  virtual  address. If specifing virtual_address, its physical
</span><span class='line'>              address is printed. It makes debugging  easy  by  comparing  the
</span><span class='line'>              output  of  this option with the one of "vtop" subcommand of the
</span><span class='line'>              crash utility.  "--vtop"  option  only  prints  the  translation
</span><span class='line'>              output, and it does not affect the dumpfile creation.
</span><span class='line'>
</span><span class='line'>       --dump-dmesg
</span><span class='line'>              This  option  overrides  the  normal  behavior  of makedumpfile.
</span><span class='line'>              Instead of  compressing  and  filtering  a  VMCORE  to  make  it
</span><span class='line'>              smaller,  it  simply  extracts  the  dmesg log from a VMCORE and
</span><span class='line'>              writes it to the specified LOGFILE. If a VMCORE does not contain
</span><span class='line'>              VMCOREINFO for dmesg, it is necessary to specfiy [-x VMLINUX] or
</span><span class='line'>              [-i VMCOREINFO].
</span><span class='line'>
</span><span class='line'>              Example:
</span><span class='line'>              # makedumpfile --dump-dmesg /proc/vmcore dmesgfile
</span><span class='line'>              # makedumpfile --dump-dmesg -x vmlinux /proc/vmcore dmesgfile
</span><span class='line'>
</span><span class='line'>       -D     Print debugging message.
</span><span class='line'>
</span><span class='line'>       -h     Show help message.
</span><span class='line'>
</span><span class='line'>       -v     Show the version of makedumpfile.
</span><span class='line'>
</span><span class='line'>ENVIRONMENT VARIABLES
</span><span class='line'>
</span><span class='line'>       TMPDIR  This environment variable is  for  a  temporary  memory  bitmap
</span><span class='line'>               file.   If  your machine has a lots of memory and you use tmpfs
</span><span class='line'>               on /tmp, makedumpfile can fail for a little memory in  the  2nd
</span><span class='line'>               kernel because makedumpfile makes a very large temporary memory
</span><span class='line'>               bitmap file in this case. To avoid this failure, you can set  a
</span><span class='line'>               TMPDIR  environment  variable.  If  you  do  not  set  a TMPDIR
</span><span class='line'>               environment variable, makedumpfile uses /tmp  directory  for  a
</span><span class='line'>               temporary bitmap file as a default.
</span><span class='line'>
</span><span class='line'>DIAGNOSTICS
</span><span class='line'>
</span><span class='line'>       makedumpfile exits with the following value.
</span><span class='line'>
</span><span class='line'>       0 : makedumpfile succeeded.
</span><span class='line'>
</span><span class='line'>       1 : makedumpfile failed without the following reasons.
</span><span class='line'>
</span><span class='line'>       2  :  makedumpfile failed due to the different version between  VMLINUX
</span><span class='line'>       and VMCORE.
</span><span class='line'>
</span><span class='line'>       3 : makedumpfile failed due to the analysis error of the memory.
</span><span class='line'>
</span><span class='line'>AUTHORS
</span><span class='line'>
</span><span class='line'>       Written by Masaki Tachibana, and Ken'ichi Ohmichi.
</span></code></pre></td></tr></table></div></figure>


<p>precise (8) <a href="http://manpages.ubuntu.com/manpages.gz/precise/man8/makedumpfile.8.gz">makedumpfile.8.gz</a></p>

<p>Provided by: <a href="https://launchpad.net/ubuntu/precise/+package/makedumpfile">makedumpfile_1.3.7-2_i386</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">kk</span></span>

      




<time class='entry-date' datetime='2014-08-06T14:46:00+08:00'><span class='date'>2014-08-06</span> <span class='time'>14:46:00</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/cats/debug/'>debug</a>, <a class='category' href='/blog/cats/debug~kdump,-crash/'>kdump、crash</a>
  
</span>


    </p>
    
      
    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/08/01/net-struct/" title="Previous Post: linux内核网络分层结构">&laquo; linux内核网络分层结构</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/08/06/tools-hydra/" title="Next Post: 暴力密码破解工具--关键在于字典">暴力密码破解工具--关键在于字典 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>
<aside class="sidebar" id='load_sidebar'>
</aside>
<script type="text/javascript">
  $('#load_sidebar').load('/sidebar.html');
</script>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - kk -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <a title="Top" href="#" id="scroll2top" style="position: fixed; height: 50px; bottom: 30px; right: 25px; cursor: pointer; z-index: 9999; display: block; opacity: 1;"><img src="/images/scrollup.png"></a>
  <script src="/javascripts/scroll2top.js"></script>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253604690'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1253604690' type='text/javascript'%3E%3C/script%3E"));</script>
</p>

</footer>
  





</body>
</html>
