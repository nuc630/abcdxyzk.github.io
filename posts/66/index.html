
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>kk Blog —— 通用基础</title>

  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="kk Blog —— 通用基础" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/category.js" type="text/javascript"></script>

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">kk Blog —— 通用基础</a></h1>
  
    <h2>cp -rf * .</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
<li>
<form action="/search" method="get">
    <input class="search" name="query" id="query" type="text" placeholder="search...">
    <input id="btnSubmit" value="search" type="submit">
</form>
<script type="text/javascript">
var query = GetRequest("query");
if (query != null) {
	document.getElementById("query").value = query;
}
</script>
</li>
  <li><a href="/atom.xml" rel="subscribe-rss">RSS</a></li>
  
</ul>
  
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/download">Download</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2014/01/09/lang-c-re-enter-fun/">可重入函数与不可重入函数</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-09T17:29:00+08:00'><span class='date'>2014-01-09</span> <span class='time'>17:29:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>可重入函数主要用于多任务环境中，简单来说就是可以被中断的函数，即在这个函数执行的任何时刻中断它，转入OS调度下去执行另外一段代 码，返回控制时不会出现什么错误；也意味着它除了使用自己栈上的变量以外不依赖于任何环境（包括static），这样的函数就是 purecode（纯代码）可重入，可以允许有该函数的多个副本在运行，由于它们使用的是分离的栈，所以不会互相干扰。而不可重入的函数由于使用了一些系 统资源，比如全局变量区、中断向量表等，所以它如果被中断的话，可能会出现问题，这类函数是不能运行在多任务环境下的。</p>

<p>可重入函数确实需要访问全局变量（包括 static），一定要注意实施互斥手段。它在并行运行环境中非常重要，但是一般要为访问全局变量付出一些性能代价。编写可重入函数时，若使用全局变量，则应通过关中断、信号量（即P、V操作）等手段对其加以保护。若对所使用的全局变量不加以保护，则此函数就不具有可重入性，即当多个进程调用此函数时，很有可能使有关全局变量变为不可知状态。</p>

<p>示例：假设Exam是 int型全局变量，函数Squre_Exam返回Exam平方值。那么如下函数不具有可重入性。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int Exam = 0;
</span><span class='line'>unsigned int example( int para )
</span><span class='line'>{
</span><span class='line'>&#9;unsigned int temp;
</span><span class='line'>&#9;Exam = para; // （**）
</span><span class='line'>&#9; temp = Square_Exam( );
</span><span class='line'>&#9;return temp;  
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>此函数若被多个进程调用的话，其结果可能是未知的，因为当（**）语句刚执行完后，另外一个使用本函数的进程可能正好被激活，那么当新激活的进程执行到此 函数时，将使Exam赋与另一个不同的para值，所以当控制重新回到“temp = Square_Exam( )”后，计算出的temp很可能不是预想中的结果。此函数应如下改进。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int Exam = 0;
</span><span class='line'>unsigned int example( int para )
</span><span class='line'>{
</span><span class='line'>&#9;unsigned int temp;  
</span><span class='line'>&#9;[申请信号量操作] //(1)  加锁  
</span><span class='line'>&#9;Exam = para;  
</span><span class='line'>&#9;temp = Square_Exam( );  
</span><span class='line'>&#9;[释放信号量操作] //     解锁   
</span><span class='line'>&#9;return temp;  
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>申请不到“信号量”，说明另外的进程正处于给Exam赋值并计算其平方过程中（即正在使用此信号）,本进程必须等待其释放信号后，才可继续执行。若申请到 信号，则可继续执行，但其它进程必须等待本进程释放信号量后，才能再使用本信号。保证函数的可重入性的方法：<br/>
  1、在写函数时候尽量使用局部变量（例如寄存器、堆栈中的变量）；<br/>
  2、对于要使用的全局变量要加以保护（如采取关中断、信号量等方法），这样构成的函数就一定是一个可重入的函数。</p>

<p>满足下列条件的函数多数是不可重入的：<br/>
  1、函数体内使用了静态的数据结构；<br/>
  2、函数体内调用了malloc()或者free()函数；<br/>
  3、函数体内调用了标准I/O函数。</p>

<p>如何将一个不可重入的函数改写成可重入函数呢？把一个不可重入函数变成可重入的唯一方法是用可重入规则来重写它。其实很简单，只要遵守了几条很容易理解的规则，那么写出来的函数就是可重入的：<br/>
  1、不要使用全局变量。因为别的代码很可能覆盖这些变量值。<br/>
  2、在和硬件发生交互的时候，切记执行类似disinterrupt()之类的操作，就是关闭硬件中断。完成交互记得打开中断，在有些系列上，这叫做“进入/ 退出核心”。<br/>
  3、不能调用其它任何不可重入的函数。<br/>
  4、谨慎使用堆栈。最好先在使用前先OS_ENTER_KERNAL。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/12/30/assembly-tail-call/">尾调用 尾递归</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-12-30T10:50:00+08:00'><span class='date'>2013-12-30</span> <span class='time'>10:50:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>尾调用</h4>

<p>尾调用大概是这么一种情况：<br/>
  函数A里面调用了函数B。<br/>
  函数B执行后，函数A马上返回。<br/>
  也就是说调用函数B（并返回执行结果）是函数A所做的最后一件事。<br/>
  相当于执行完函数B后，函数A也就执行完。<br/>
因此在执行函数B时，函数A的栈帧其实是已经大部分没用了，可以被修改或覆盖。编译器可以利用这一点进行优化，函数B执行后直接返回到函数A的调用者。</p>

<p>这里有一点需要注意：它是来自于编译器的优化。 这一点点的优化对于普通的尾调用来说可能意义不大，但是对于尾递归来说就很重要了。</p>

<h4>尾递归</h4>

<p>尾递归是一种基于尾调用形式的递归，相当于前面说的函数B就是函数A本身。</p>

<p>普通递归会存在的一些问题是，每递归一层就会消耗一定的栈空间，递归过深还可能导致栈溢出，同时又是函数调用，免不了push来pop去的，消耗时间。</p>

<p>采用尾调用的形式来实现递归，即尾递归，理论上可以解决普通递归的存在的问题。因为下一层递归所用的栈帧可以与上一层有重叠（利用jmp来实现），局部变量可重复利用，不需要额外消耗栈空间，也没有push和pop。</p>

<p>再次提一下，它的实际效果是来自于编译器的优化（目前的理解）。在使用尾递归的情况下，编译器觉得合适就会将递归调用优化成循环。目前大多数编译器 都是支持尾递归优化的。有一些语言甚至十分依赖于尾递归（尾调用），比如erlang或其他函数式语言（传说它们为了更好的处理 continuation-passing style）。</p>

<p>假如不存在优化，大家真刀真枪进行函数调用，那尾递归是毫无优势可言的，甚至还有缺点——代码写起来不直观。</p>

<p>现代编译器的优化能力很强悍，很多情况下编译器优化起来毫不手软（于是有了volatile）。但有时编译器又很傲娇，你需要主动给它一点信号，它才肯优化。尾递归就相当于传递一个信号给编译器，尽情优化我吧！</p>

<h4>测试</h4>

<p>为了验证尾递归优化，可以写个小程序进行测试。在VS2010下将使用/O1或以上的优化选项，一般就会尾递归优化。Gcc3.2.2（这版本好旧）下一般需要使用-O2优化选项。<br/>
先看看普通递归：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// 递归
</span><span class='line'>int factorial(int n)
</span><span class='line'>{
</span><span class='line'>&#9;if(n &lt;= 2)
</span><span class='line'>&#9;{
</span><span class='line'>&#9;&#9;return 1;
</span><span class='line'>&#9;}
</span><span class='line'>&#9;else
</span><span class='line'>&#9;{
</span><span class='line'>&#9;&#9;return factorial(n-1) + factorial(n-2);
</span><span class='line'>&#9;}
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>其汇编代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0100401371    push   %ebp
</span><span class='line'>0200401372    mov    %esp,%ebp
</span><span class='line'>0300401374    push   %ebx
</span><span class='line'>0400401375    sub    $0x14,%esp
</span><span class='line'>0500401378    cmpl   $0x2,0x8(%ebp)
</span><span class='line'>060040137C    jg     0x401385 &lt;factorial+20&gt;
</span><span class='line'>070040137E    mov    $0x1,%eax
</span><span class='line'>0800401383    jmp    0x4013a4 &lt;factorial+51&gt;
</span><span class='line'>0900401385    mov    0x8(%ebp),%eax
</span><span class='line'>1000401388    dec    %eax
</span><span class='line'>1100401389    mov    %eax,(%esp)
</span><span class='line'>120040138C    call   0x401371 &lt;factorial&gt;
</span><span class='line'>1300401391    mov    %eax,%ebx
</span><span class='line'>1400401393    mov    0x8(%ebp),%eax
</span><span class='line'>1500401396    sub    $0x2,%eax
</span><span class='line'>1600401399    mov    %eax,(%esp)
</span><span class='line'>170040139C    call   0x401371 &lt;factorial&gt;
</span><span class='line'>18004013A1    lea    (%ebx,%eax,1),%eax
</span><span class='line'>19004013A4    add    $0x14,%esp
</span><span class='line'>20004013A7    pop    %ebx
</span><span class='line'>21004013A8    leave
</span><span class='line'>22004013A9    ret</span></code></pre></td></tr></table></div></figure>


<p>在0040138C,0040139C这些位置，我们看到递归仍然是使用call指令，那么尾递归在汇编角度是怎么处理的呢？<br/>
尾递归：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int factorial_tail(int n,int acc1,int acc2)
</span><span class='line'>{
</span><span class='line'>  if (n &lt; 2)
</span><span class='line'>  {
</span><span class='line'>      return acc1;
</span><span class='line'>  }
</span><span class='line'>  else
</span><span class='line'>  {
</span><span class='line'>      return factorial_tail(n-1,acc2,acc1+acc2);
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>其汇编代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0100401381    push   %ebp
</span><span class='line'>0200401382    mov    %esp,%ebp
</span><span class='line'>0300401384    sub    $0x18,%esp
</span><span class='line'>0400401387    cmpl   $0x1,0x8(%ebp)
</span><span class='line'>050040138B    jg     0x401392 &lt;factorial_tail+17&gt;
</span><span class='line'>060040138D    mov    0xc(%ebp),%eax
</span><span class='line'>0700401390    jmp    0x4013b2 &lt;factorial_tail+49&gt;
</span><span class='line'>0800401392    mov    0x10(%ebp),%eax
</span><span class='line'>0900401395    mov    0xc(%ebp),%edx
</span><span class='line'>1000401398    lea    (%edx,%eax,1),%eax
</span><span class='line'>110040139B    mov    0x8(%ebp),%edx
</span><span class='line'>120040139E    dec    %edx
</span><span class='line'>130040139F    mov    %eax,0x8(%esp)
</span><span class='line'>14004013A3    mov    0x10(%ebp),%eax
</span><span class='line'>15004013A6    mov    %eax,0x4(%esp)
</span><span class='line'>16004013AA    mov    %edx,(%esp)
</span><span class='line'>17004013AD    call   0x401381 &lt;factorial_tail&gt;
</span><span class='line'>18004013B2    leave
</span><span class='line'>19004013B3    ret</span></code></pre></td></tr></table></div></figure>


<p>在00401390位置上，尾递归是直接使用jmp实现循环跳转。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/12/25/debug-kprobe-doc/">kprobes Documentation</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-12-25T14:04:00+08:00'><span class='date'>2013-12-25</span> <span class='time'>14:04:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://www.kernel.org/doc/Documentation/kprobes.txt">https://www.kernel.org/doc/Documentation/kprobes.txt</a></p>

<p>Documentation/kprobes.txt</p>

<h4>1.4 How Does Jump Optimization Work?</h4>

<p>If your kernel is built with CONFIG_OPTPROBES=y (currently this flag<br/>
is automatically set &lsquo;y&rsquo; on x86/x86-64, non-preemptive kernel) and<br/>
the &ldquo;debug.kprobes_optimization&rdquo; kernel parameter is set to 1 (see<br/>
sysctl(8)), Kprobes tries to reduce probe-hit overhead by using a jump<br/>
instruction instead of a breakpoint instruction at each probepoint.</p>

<h5>1.4.1 Init a Kprobe</h5>

<p>When a probe is registered, before attempting this optimization,<br/>
Kprobes inserts an ordinary, breakpoint-based kprobe at the specified<br/>
address. So, even if it&rsquo;s not possible to optimize this particular<br/>
probepoint, there&rsquo;ll be a probe there.</p>

<h5>1.4.2 Safety Check</h5>

<p>Before optimizing a probe, Kprobes performs the following safety checks:</p>

<ul>
<li><p>Kprobes verifies that the region that will be replaced by the jump<br/>
instruction (the &ldquo;optimized region&rdquo;) lies entirely within one function.<br/>
(A jump instruction is multiple bytes, and so may overlay multiple<br/>
instructions.)</p></li>
<li><p>Kprobes analyzes the entire function and verifies that there is no<br/>
jump into the optimized region.  Specifically:</p>

<ul>
<li>the function contains no indirect jump;</li>
<li>the function contains no instruction that causes an exception (since<br/>
the fixup code triggered by the exception could jump back into the<br/>
optimized region &ndash; Kprobes checks the exception tables to verify this);<br/>
and</li>
<li>there is no near jump to the optimized region (other than to the first<br/>
byte).</li>
</ul>
</li>
<li><p>For each instruction in the optimized region, Kprobes verifies that<br/>
the instruction can be executed out of line.</p></li>
</ul>


<h5>1.4.3 Preparing Detour Buffer</h5>

<p>Next, Kprobes prepares a &ldquo;detour&rdquo; buffer, which contains the following<br/>
instruction sequence:<br/>
- <span style="color:red">code to push the CPU&rsquo;s registers (emulating a breakpoint trap)</span><br/>
- <span style="color:red">a call to the trampoline code which calls user&rsquo;s probe handlers.</span><br/>
- <span style="color:red">code to restore registers</span><br/>
- <span style="color:red">the instructions from the optimized region</span><br/>
- <span style="color:red">a jump back to the original execution path.</span></p>

<h5>1.4.4 Pre-optimization</h5>

<p>After preparing the detour buffer, Kprobes verifies that none of the<br/>
following situations exist:<br/>
- <span style="color:red">The probe has either a break_handler (i.e., it&rsquo;s a jprobe) or a post_handler.</span><br/>
- <span style="color:red">Other instructions in the optimized region are probed.</span><br/>
- <span style="color:red">The probe is disabled.</span></p>

<p>In any of the above cases, Kprobes won&rsquo;t start optimizing the probe.<br/>
Since these are temporary situations, Kprobes tries to start<br/>
optimizing it again if the situation is changed.</p>

<p>If the kprobe can be optimized, Kprobes enqueues the kprobe to an<br/>
optimizing list, and kicks the kprobe-optimizer workqueue to optimize<br/>
it.  If the to-be-optimized probepoint is hit before being optimized,<br/>
Kprobes returns control to the original instruction path by setting<br/>
the CPU&rsquo;s instruction pointer to the copied code in the detour buffer<br/>
&ndash; thus at least avoiding the single-step.</p>

<h5>1.4.5 Optimization</h5>

<p>The Kprobe-optimizer doesn&rsquo;t insert the jump instruction immediately;<br/>
rather, it calls synchronize_sched() for safety first, because it&rsquo;s<br/>
possible for a CPU to be interrupted in the middle of executing the<br/>
optimized region(*).  As you know, synchronize_sched() can ensure<br/>
that all interruptions that were active when synchronize_sched()<br/>
was called are done, but only if CONFIG_PREEMPT=n.  So, this version<br/>
of kprobe optimization supports only kernels with CONFIG_PREEMPT=n.(**)</p>

<p>After that, the Kprobe-optimizer calls stop_machine() to replace<br/>
the optimized region with a jump instruction to the detour buffer,<br/>
using text_poke_smp().</p>

<h5>1.4.6 Unoptimization</h5>

<p>When an optimized kprobe is unregistered, disabled, or blocked by<br/>
another kprobe, it will be unoptimized.  If this happens before<br/>
the optimization is complete, the kprobe is just dequeued from the<br/>
optimized list.  If the optimization has been done, the jump is<br/>
replaced with the original code (except for an int3 breakpoint in<br/>
the first byte) by using text_poke_smp().</p>

<p>(<em>)Please imagine that the 2nd instruction is interrupted and then<br/>
the optimizer replaces the 2nd instruction with the jump </em>address*<br/>
while the interrupt handler is running. When the interrupt<br/>
returns to original address, there is no valid instruction,<br/>
and it causes an unexpected result.</p>

<p>(**)This optimization-safety checking may be replaced with the<br/>
stop-machine method that ksplice uses for supporting a CONFIG_PREEMPT=y<br/>
kernel.</p>

<p>NOTE for geeks:<br/>
<span style="color:red">The jump optimization changes the kprobe&rsquo;s pre_handler behavior.</span><br/>
<span style="color:red">Without optimization, the pre_handler can change the kernel&rsquo;s execution</span><br/>
<span style="color:red">path by changing regs->ip and returning 1.  However, when the probe</span><br/>
<span style="color:red">is optimized, that modification is ignored.  Thus, if you want to</span><br/>
<span style="color:red">tweak the kernel&rsquo;s execution path, you need to suppress optimization,</span><br/>
<span style="color:red">using one of the following techniques:</span><br/>
- <span style="color:blue">Specify an empty function for the kprobe&rsquo;s post_handler or break_handler.</span><br/>
 or<br/>
- <span style="color:blue">Execute &lsquo;sysctl -w debug.kprobes_optimization=n&rsquo;</span></p>

<p>&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;..</p>

<h4>5. Kprobes Features and Limitations</h4>

<p>Kprobes allows multiple probes at the same address.  Currently,<br/>
however, there cannot be multiple jprobes on the same function at<br/>
the same time.  Also, a probepoint for which there is a jprobe or<br/>
a post_handler cannot be optimized.  So if you install a jprobe,<br/>
or a kprobe with a post_handler, at an optimized probepoint, the<br/>
probepoint will be unoptimized automatically.</p>

<p>In general, you can install a probe anywhere in the kernel.<br/>
In particular, you can probe interrupt handlers.  Known exceptions<br/>
are discussed in this section.</p>

<p>The register_<em>probe functions will return -EINVAL if you attempt<br/>
to install a probe in the code that implements Kprobes (mostly<br/>
kernel/kprobes.c and arch/</em>/kernel/kprobes.c, but also functions such<br/>
as do_page_fault and notifier_call_chain).</p>

<p>If you install a probe in an inline-able function, Kprobes makes<br/>
no attempt to chase down all inline instances of the function and<br/>
install probes there.  gcc may inline a function without being asked,<br/>
so keep this in mind if you&rsquo;re not seeing the probe hits you expect.</p>

<p>A probe handler can modify the environment of the probed function<br/>
&ndash; e.g., by modifying kernel data structures, or by modifying the<br/>
contents of the pt_regs struct (which are restored to the registers<br/>
upon return from the breakpoint).  So Kprobes can be used, for example,<br/>
to install a bug fix or to inject faults for testing.  Kprobes, of<br/>
course, has no way to distinguish the deliberately injected faults<br/>
from the accidental ones.  Don&rsquo;t drink and probe.</p>

<p>Kprobes makes no attempt to prevent probe handlers from stepping on<br/>
each other &ndash; e.g., probing printk() and then calling printk() from a<br/>
probe handler.  If a probe handler hits a probe, that second probe&rsquo;s<br/>
handlers won&rsquo;t be run in that instance, and the kprobe.nmissed member<br/>
of the second probe will be incremented.</p>

<p>As of Linux v2.6.15-rc1, multiple handlers (or multiple instances of<br/>
the same handler) may run concurrently on different CPUs.</p>

<p>Kprobes does not use mutexes or allocate memory except during<br/>
registration and unregistration.</p>

<p>Probe handlers are run with preemption disabled.  Depending on the<br/>
architecture and optimization state, handlers may also run with<br/>
interrupts disabled (e.g., kretprobe handlers and optimized kprobe<br/>
handlers run without interrupt disabled on x86/x86-64).  In any case,<br/>
your handler should not yield the CPU (e.g., by attempting to acquire<br/>
a semaphore).</p>

<p>Since a return probe is implemented by replacing the return<br/>
address with the trampoline&rsquo;s address, stack backtraces and calls<br/>
to <code>__builtin_return_address()</code> will typically yield the trampoline&rsquo;s<br/>
address instead of the real return address for kretprobed functions.<br/>
(As far as we can tell, <code>__builtin_return_address()</code> is used only<br/>
for instrumentation and error reporting.)</p>

<p>If the number of times a function is called does not match the number<br/>
of times it returns, registering a return probe on that function may<br/>
produce undesirable results. In such a case, a line:<br/>
kretprobe BUG!: Processing kretprobe d000000000041aa8 @ c00000000004f48c<br/>
gets printed. With this information, one will be able to correlate the<br/>
exact instance of the kretprobe that caused the problem. We have the<br/>
do_exit() case covered. do_execve() and do_fork() are not an issue.<br/>
We&rsquo;re unaware of other specific cases where this could be a problem.</p>

<p>If, upon entry to or exit from a function, the CPU is running on<br/>
a stack other than that of the current task, registering a return<br/>
probe on that function may produce undesirable results.  For this<br/>
reason, Kprobes doesn&rsquo;t support return probes (or kprobes or jprobes)<br/>
on the x86_64 version of <code>__switch_to()</code>; the registration functions<br/>
return -EINVAL.</p>

<p><kk style="color:red">
On x86/x86-64, since the Jump Optimization of Kprobes modifies<br/>
instructions widely, there are some limitations to optimization. To<br/>
explain it, we introduce some terminology. Imagine a 3-instruction<br/>
sequence consisting of a two 2-byte instructions and one 3-byte<br/>
instruction.<br/>
</kk></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>        IA  
</span><span class='line'>         |  
</span><span class='line'>[-2][-1][0][1][2][3][4][5][6][7]  
</span><span class='line'>        [ins1][ins2][  ins3 ]  
</span><span class='line'>        [&lt;-     DCR       -&gt;]  
</span><span class='line'>           [&lt;- JTPR -&gt;]  </span></code></pre></td></tr></table></div></figure>


<p>
<kk style="color:red">
ins1: 1st Instruction<br/>
ins2: 2nd Instruction<br/>
ins3: 3rd Instruction<br/>
IA:  Insertion Address<br/>
JTPR: Jump Target Prohibition Region<br/>
DCR: Detoured Code Region<br/>
</kk></p>

<p><kk style="color:red">
The instructions in DCR are copied to the out-of-line buffer<br/>
of the kprobe, because the bytes in DCR are replaced by<br/>
a 5-byte jump instruction. So there are several limitations.<br/>
</kk></p>

<p><kk style="color:red">
a) The instructions in DCR must be relocatable.<br/>
b) The instructions in DCR must not include a call instruction.<br/>
c) JTPR must not be targeted by any jump or call instruction.<br/>
d) DCR must not straddle the border between functions.<br/>
</kk></p>

<p><kk style="color:red">
Anyway, these limitations are checked by the in-kernel instruction<br/>
decoder, so you don&rsquo;t need to worry about that.<br/>
</kk></p>

<h4>6. Probe Overhead</h4>

<p>On a typical CPU in use in 2005, a kprobe hit takes 0.5 to 1.0<br/>
microseconds to process.  Specifically, a benchmark that hits the same<br/>
probepoint repeatedly, firing a simple handler each time, reports 1-2<br/>
million hits per second, depending on the architecture.  A jprobe or<br/>
return-probe hit typically takes 50-75% longer than a kprobe hit.<br/>
When you have a return probe set on a function, adding a kprobe at<br/>
the entry to that function adds essentially no overhead.</p>

<p>Here are sample overhead figures (in usec) for different architectures.<br/>
k = kprobe; j = jprobe; r = return probe; kr = kprobe + return probe<br/>
on same function; jr = jprobe + return probe on same function</p>

<p>i386: Intel Pentium M, 1495 MHz, 2957.31 bogomips<br/>
k = 0.57 usec; j = 1.00; r = 0.92; kr = 0.99; jr = 1.40</p>

<p>x86_64: AMD Opteron 246, 1994 MHz, 3971.48 bogomips<br/>
k = 0.49 usec; j = 0.76; r = 0.80; kr = 0.82; jr = 1.07</p>

<p>ppc64: POWER5 (gr), 1656 MHz (SMT disabled, 1 virtual CPU per physical CPU)<br/>
k = 0.77 usec; j = 1.31; r = 1.26; kr = 1.45; jr = 1.99</p>

<h5>6.1 Optimized Probe Overhead</h5>

<p>Typically, an optimized kprobe hit takes 0.07 to 0.1 microseconds to<br/>
process. Here are sample overhead figures (in usec) for x86 architectures.<br/>
k = unoptimized kprobe, b = boosted (single-step skipped), o = optimized kprobe,<br/>
r = unoptimized kretprobe, rb = boosted kretprobe, ro = optimized kretprobe.</p>

<p>i386: Intel&reg; Xeon&reg; E5410, 2.33GHz, 4656.90 bogomips<br/>
k = 0.80 usec; b = 0.33; o = 0.05; r = 1.10; rb = 0.61; ro = 0.33</p>

<p>x86-64: Intel&reg; Xeon&reg; E5410, 2.33GHz, 4656.90 bogomips<br/>
<span style="color:red">k = 0.99 usec; b = 0.43; o = 0.06; r = 1.24; rb = 0.68; ro = 0.30</span></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/12/23/assembly-opcode/">深入浅出指令编码之三：64位计算</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-12-23T17:55:00+08:00'><span class='date'>2013-12-23</span> <span class='time'>17:55:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.pediy.com/kssd/pediy10/77824.html">http://www.pediy.com/kssd/pediy10/77824.html</a></p>

<p>  AMD 在x86体系的32位计算扩展为64位计算，这是通过什么来实现的？它是怎样设计的？具体细节是什么？这就是这一节要讲解的。</p>

<h4>一、硬件编程资源</h4>

<p>　　了解现在processor提供编程资源是很重要的，对要进一步学习提供材料，下面分别讲解x86的编程资源和x64的编程资源。</p>

<h5>1、x86的32位编程资源</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>●  8个32位通用寄存器：EAX、ECX、EDX、EBX、ESP、EBP、ESI、EDI
</span><span class='line'>　　　这些寄存器还可分解为8个8位寄存器：AL、CL、DL、BL、AH、CH、DH、BH
</span><span class='line'>　　　和8个16位寄存器：AX、CX、DX、BX、SP、BP、SI、DI
</span><span class='line'>●  6个段寄存器：ES、CS、SS、DS、FS、GS
</span><span class='line'>●  32位的EFLAGS 标志位寄存器
</span><span class='line'>●  32位的指令指针寄存器EIP
</span><span class='line'>●  8个64位MMX寄存器
</span><span class='line'>●  8个128位XMM寄存器
</span><span class='line'>●  还有就是32位的寻址空间（Virtual Address Space）</span></code></pre></td></tr></table></div></figure>


<h5>2、x64的64位编程资源</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>●  32位通用寄存器被扩展至64位，除了原有的8个寄存器，新增8个寄存器，共16个通用寄存器：RAX、RCX、RDX、RBX、RSP、RBP、RSI、RDI、R8、R9、R10、R11、R12、R13、R14、R15
</span><span class='line'>●  保留了原有的6个寄存器，但是作用被限制
</span><span class='line'>●  32位的标志寄存器被扩展为64位的标志寄存器RELAGS
</span><span class='line'>●  8个64位MMX寄存器不变
</span><span class='line'>●  新增8个XMM寄存器，共16个XMM寄存器
</span><span class='line'>●  还有就是64位的寻址空间（Virtaul Address Space）</span></code></pre></td></tr></table></div></figure>


<h4>二、寄存器编码（或者说ID值）</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>●  16个64位通用寄存器是： 0000 ~ 1111，也就是：0 ~ 15
</span><span class='line'>　　　　8个32位通用寄存器是：　000 ~ 111 也就是：0 ~ 7
</span><span class='line'>●  6个段寄存器的编码是：000 ~ 101　也就是：0 ~ 5
</span><span class='line'>●  MMX寄存器编码是： 000 ~ 111　也就是：0 ~ 7
</span><span class='line'>●  16个XMM寄存器编码是： 0000 ~ 1111 也就是：0 ~ 15
</span><span class='line'>　　　　8个XMM寄存器编码是：000 ~ 111 也就是：0 ~ 7</span></code></pre></td></tr></table></div></figure>


<p>所谓寄存器编码是寄存器对应的二进制编码，按顺序来定义，看下面的表格：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>RAX/ES/MMX0/XMM0　-&gt;  0000
</span><span class='line'>RCX/CS/MMX1/XMM1  -&gt;  0001
</span><span class='line'>RDX/SS/MMX2/XMM2  -&gt;  0010
</span><span class='line'>RBX/DS/MMX3/XMM3  -&gt;  0011
</span><span class='line'>RSP/FS/MMX4/XMM4   -&gt;  0100
</span><span class='line'>RBP/GS/MMX5/XMM5  -&gt;  0101
</span><span class='line'>RSI/MMX6/XMM6      -&gt;  0110
</span><span class='line'>RDI/MMX7/XMM7     -&gt;  0111
</span><span class='line'>R8/XMM8 　 -&gt;  1000
</span><span class='line'>R9/XMM9 　 -&gt;  1001
</span><span class='line'>R10/XMM10  -&gt;  1010
</span><span class='line'>R11/XMM11  -&gt;  1011
</span><span class='line'>R12/XMM12  -&gt;  1100
</span><span class='line'>R13/XMM13  -&gt;  1101
</span><span class='line'>R14/XMM14  -&gt;  1110
</span><span class='line'>R15/XMM15  -&gt;  1111</span></code></pre></td></tr></table></div></figure>


<p>  RAX ~ RDI　与　EAX ~ EDI　的编码是相同的，这里有一个情况是，EAX ~ EDI的编码是3位，为什么RAX~RDI的编码却是4位呢？这就是下面要讲到的REX prefix会将寄存器编码进行扩展。</p>

<h4>三、  开启64位计算的基石（REX prefix）</h4>

<p>　　AMD64体系的64位计算是这样设计：操作数的Default Operand-Size是32位，而Address-Size是固定为64位的，这里就引发3个问题要解决的：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>●  问题1：当要访问是64位的寄存器时，那么必须要有一种机制去开启或者说确认访问的寄存器是64位的。
</span><span class='line'>●  问题2：而要访问的内存操作数寄存器寻址的话，那么也必须要去开启或确认寄存器是64位的以及访问新增寄存的问题。
</span><span class='line'>●  问题3：如何去访问新增加的几个寄存器呢？那么也必须要有方法去访问增加的寄存器？</span></code></pre></td></tr></table></div></figure>


<p>  那么在64位Long模式下，为什么不将操作数的Default Operand-Size设计为64位呢？那是由于体系限制，本来AMD64就是在 x86的基础上扩展为64位的。x86体系当初设计时就没想到有会被扩展到64位的时候。所以在Segment-Descriptor（段描述符）里就没 有可以扩展为64位的标志位。DS.D位只有置1时是32位，清0时为16位，这两种情况。</p>

<p>  AMD在保持兼容的大提前下，只好令谋计策，AMD的解决方案是：增加一个64位模式下特有Prefix，以起到扩展访问64位的能力。这就是 REX prefix。</p>

<h5>1、REX prefix 的具体格式及含义</h5>

<p>  REX prefix的取值范围是：40 ~ 4F（0100 0000 ~ 0100 1111），来看下原来opcode取值范围的40 ~ 4F的是什么指令：<br/>
  Opcode为40 ~ 47在x86下是inc eax ~ inc edi　指令，48 ~ 4F在x86下是dec eax ~ dec edi　指令。<br/>
  在64位模式下，40 ~ 4F 就已经不是指令而变身为 prefix了。</p>

<h6>1.1  REX prefix字节的组成部分：</h6>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>●  bit0：REX.B
</span><span class='line'>●  bit1：REX.X
</span><span class='line'>●  bit2：REX.R
</span><span class='line'>●  bit3：REX.W
</span><span class='line'>●  bit4 ~ bit7：此域固定为0100，也就是高半字节为4。</span></code></pre></td></tr></table></div></figure>


<p>★  REX.W域是设定操作数的大小（Operand-Size），当REX.W为1时，操作数是64位，为0时，操作数的大小是缺省大小（Default Opeand-Size）。这就解决了访问64位寄存器的问题。</p>

<p>★  REX.R域是用于扩展ModRM字节中的R（Reg）域，ModRM中的Reg域除了对Opcode的补充外，是用来定义寄存器的编码，即寄存器 值。REX.R将原来3位的寄存器ID（000 ~ 111）扩展为4位（0000 ~ 1111），这就解决了访新增寄存器的问题。</p>

<p>★  REX.X域是用于扩展SIB字节中的Index域，SIB中的Index域是指明Index 寄存器的编码，即ID值。这就解决了寄存器寻址内存中使用新增寄存器的问题。</p>

<p>★  REX.B域是用于扩展ModRM字节中的r/m域和SIB中的Base域，SIB中的Base域指明Base寄存器编码即ID值。这就解决了寄存器寻址内存中使用新增寄存器的问题。</p>

<p>★  REX.B域的另一个作用是：若指令中没有ModRM和SIB，也就是在Opcode中直接给出寄存器ID值，REX.B起到扩展寄存器的作用。</p>

<h6>1.2、下面使用几个例子来说明问题：</h6>

<p>例1：指令 mov eax, 1　　
这条指令的Default Operand-Size是32位，在32位下它的机器编码是：b8 01 00 00 00（其5个字节）若改成64位编码时，变成 mov rax, 1。<br/>
　　此时，它的机器编码是 48 b8 01 00 00 00 00 00 00 00 （共10个字节）<br/>
  在这里48 就是 REX prefix字节，即：0100 1000　它的各个域值是：REX.W = 1，定义操作数是64位的，REX.R = 0、REX.X = 0、 REX.B = 0　这条指令不需要ModRM和SIB字节，所以RXB域都为0。<br/>
　　这里有个值得思考的地方，若 REX.W域为0时，这条指令的操作数是32位的，也就是说，机器编码：40 b8 01 00 00 00（其6个字节）是与 b8 01 00 00 00结果一样的，都是mov eax, 1</p>

<p>例2：指令：mov rax, r14<br/>
　　这是一条常见64位指令，源寄存器是r14，目标寄存器是rax 它的机器编码是：<br/>
　　　4c 89 f0（共3个字节）<br/>
在这个编码里4c是REX prefix，89是opcode，f0是ModRM。<br/>
REX Prefix的值是4c （0100 1100），其中REX.W = 1，REX.R = 1，XB都为0。<br/>
ModRM的值是F0（11-110-000），Mod=11，Reg=110, R/M = 000，在这里先不讲ModRM的含义，在后面的章节再详述。在这条指令里，Reg表示源操作数r14的ID值。<br/>
r14是新增加寄存器，所以需要REX.R进行扩展，得出最终寄存器的ID值，1+110 = 1110，这是r14寄存器的ID值，从而得出正确的编码。</p>

<p>例3：回到序言里的例子：mov word ptr es:[eax + ecx * 8 + 0x11223344], 0x12345678<br/>
作为例子，我将它改为64位指令，如下：<br/>
mov qword ptr [rax + rcx * 8 + 0x11223344], 0x12345678<br/>
操作数大小变为64位，而base 寄存器和index寄存器都改为64位，disp（offset）和imme（值不变），为啥不变？在以后的章节会有详述。</p>

<p>好，现在来看看指令怎么译：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(1)  REX.W：　要置为 1 以扩展64位大小。
</span><span class='line'>(2)  REX.B：  由于base不是新增的寄存器，所以置为 0
</span><span class='line'>(3)  REX.X：　由于index 也不是新增的寄存器，所以置为 0
</span><span class='line'>(4)  REX.R：　源操作数和目标作数不是寄存器，所以置为 0</span></code></pre></td></tr></table></div></figure>


<p>所以，REX prefix就等于 48（0100 1000）<br/>
故，整条指令编码是：48 c7 84 c8 44 33 22 11 78 56 34 12（共12个字节）</p>

<p>例4：我将上面的例子再改一改，变为：mov qword ptr [r8 + r9 * 8 + 0x11223344], 0x12345678<br/>
那么，看看这指令怎么译：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>（1）  REX.W：置1，使用64位大小
</span><span class='line'>（2）  REX.B：base寄存器是r8，是新增寄存器，所以置为1
</span><span class='line'>（3）  REX.X：index寄存器是r9，是新增寄存器，所以置为1
</span><span class='line'>（4）  REX.R：操作数中没有寄存器，所在置为0</span></code></pre></td></tr></table></div></figure>


<p>所以，REX　prefix就等于（0100 1011）4b<br/>
故，整条指令编码是：4b c7 84 c8 44 33 22 11 78 56 34 12（共12个字节）</p>

<p>例5：看看这条指令 mov r8, 1</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>（1）  REX.W：置1
</span><span class='line'>（2）  REX.B：访问Opcode中的寄存器ID值，它是新增寄存器，所为置1
</span><span class='line'>（3）  REX.X：置0
</span><span class='line'>（4）  REX.R：置0</span></code></pre></td></tr></table></div></figure>


<p>所以，REX是 49（0100 1001）<br/>
故整条指令编码是：49 b8 01 00 00 00 00 00 00 00</p>

<h5>2、REX prefix补充说明</h5>

<p>（1）关于顺序：REX一定是在x86 prefix之后，而在Opcode之前。<br/>
（2）关于冲突：当x86 prefix和 REX prefix同时出现，而又出现冲突时，REX的优先权要优于 x86 prefix，<br/>
  举个例子：指令 mov r8, 1<br/>
  若出现以下编码怎么办：66 49 b8 01 00 00 00 00 00 00 00　既有66 又有49，那么结果66会被忽略，也就等于：49 b8 01 00 00 00 00 00 00 00。<br/>
  而对于 66 b8 01 00 00 00 00 00 00 00　这个编码来说：会被解析为：mov ax, 1<br/>
  去掉了49这个REX prefix操作数被调整为 16　位。<br/>
（3）关于原来Opcode码，由于40 ~ 4F被作为 REX prefix，那么原指令inc reg/dec reg，只能使用 FF/0　和 FF/1　这两个Opcode了。<br/>
（4）缺省操作数大小（Default Operand-Size）<br/>
  64位绝大部分缺省操作数是32位的，但有一部分是64位的，依赖于rsp的寻址和短跳转（near jmp/near call）是64位的。<br/>
  如下指令：push r8<br/>
  REX值是41（0100 0001），即REX.W为0，使用default opearnd-size<br/>
  它的编码是 41 ff f0</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/12/04/debug-source-debug/">How source debuggers work?</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-12-04T09:51:00+08:00'><span class='date'>2013-12-04</span> <span class='time'>09:51:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blog.techveda.org/howsourcedebuggerswork/">http://blog.techveda.org/howsourcedebuggerswork/</a></p>

<p>Application binaries are a result of compile and build operations performed on a single or a set of source files. Program Source files contain functions, data variables of various types (local, global, register, static), and abstract data objects, all written and neatly indented with nested control structures as per high level programming language syntax (C/C++).  Compilers translate code in each source file into machine instructions (1’s and 0’s) as per target processors Instruction set Architecture and bury that code into object files. Further, Linkers integrate compiled object files with other pre-compiled objects files (libraries, runtime binaries) to create end application binary image called executable.</p>

<p>Source debuggers are tools used to trace execution of an application executable binary. Most amazing feature of a source debugger is its ability to list source code of the program being debugged; it can show the line or expression in the source code that resulted in a particular machine code instruction of a running program loaded in memory. This helps the programmer to analyze a program’s behavior in the high-level terms like source-level flow control constructs, procedure calls, named variables, etc,  instead of machine instructions and memory locations. Source-level debugging also makes it possible to step through execution a line at a time and set source-level breakpoints. (If you do not have any prior hands on experience with source debuggers I suggest you to look at this before continuing with following.)</p>

<p>lets explore how source debuggers like gnu gdb work ? So how does a debugger know where to stop when you ask it to break at the entry to some function? How does it manage to find what to show you when you ask it for the value of a variable? The answer is – debug information.  All modern compilers are designed to generate Debug information together with the machine code of the source file. It is a representation of the relationship between the executable program and the original source code. This information is encoded as per  a pre-defined format and stored alongside the machine code. Many such formats were invented over the years for different platforms and executable files (aim of this article isn’t to survey the history of these formats, but rather to show how they work). Gnu compiler and ELF executable on Linux/ UNIX platforms use DWARF, which is widely used today as default debugging information format.</p>

<p>Word of Advice : Does an Application/ Kernel programmer need to know Dwarf?</p>

<p>Obvious answer to this question is a big NO.  It is purely subject matter for developers involved in implementation of a Debugger tool. A normal Application developer using debugger tools would never need to learn or dig into binary files for debug information. This in no way adds any edge to your debugging skills nor adds any new skills into your armory. However, if you are a developer using debuggers for years and curious about how debuggers work read this document for an outline into debug information.  If you are a beginner to systems programming or fresher’s learning programming I would  suggest  not to waste your time as you can safely ignore this.</p>

<p>ELF -DWARF sections</p>

<p>Gnu compiler generates debug information which is organized into various sections of the ELF object file. Let’s use the following source file for compiling and observing DWARF sections</p>

<p>root@techveda:~# vim sample.c</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'> 
</span><span class='line'>int add(int x, int y)
</span><span class='line'>{
</span><span class='line'>&#9;return x + y;
</span><span class='line'>}
</span><span class='line'>int main()
</span><span class='line'>{
</span><span class='line'>&#9;int a = 10, b = 20;
</span><span class='line'>&#9;int result;
</span><span class='line'>&#9;int (*fp) (int, int);
</span><span class='line'> 
</span><span class='line'>&#9;fp = add;
</span><span class='line'>&#9;result = (*fp) (a, b);
</span><span class='line'>&#9;printf(" %dn", result);
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>root@techveda:~# gcc -c -g sample.c -o sample.o
</span><span class='line'>root@techveda:~# objdump -h sample.o | more
</span><span class='line'>
</span><span class='line'>sample.o:     file format elf32-i386
</span><span class='line'> 
</span><span class='line'>Sections:
</span><span class='line'>Idx Name          Size      VMA       LMA       File off  Algn
</span><span class='line'>  0 .text         0000005f  00000000  00000000  00000034  2**2
</span><span class='line'>              CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE
</span><span class='line'>  1 .data         00000000  00000000  00000000  00000094  2**2
</span><span class='line'>              CONTENTS, ALLOC, LOAD, DATA
</span><span class='line'>  2 .bss          00000000  00000000  00000000  00000094  2**2
</span><span class='line'>              ALLOC
</span><span class='line'>  3 .debug_abbrev 000000a2  00000000  00000000  00000094  2**0
</span><span class='line'>              CONTENTS, READONLY, DEBUGGING
</span><span class='line'>  4 .debug_info   00000114  00000000  00000000  00000136  2**0
</span><span class='line'>              CONTENTS, RELOC, READONLY, DEBUGGING
</span><span class='line'>  5 .debug_line   00000040  00000000  00000000  0000024a  2**0
</span><span class='line'>              CONTENTS, RELOC, READONLY, DEBUGGING
</span><span class='line'>  6 .rodata       00000005  00000000  00000000  0000028a  2**0
</span><span class='line'>              CONTENTS, ALLOC, LOAD, READONLY, DATA
</span><span class='line'>  7 .debug_loc    00000070  00000000  00000000  0000028f  2**0
</span><span class='line'>              CONTENTS, READONLY, DEBUGGING
</span><span class='line'>  8 .debug_pubnames 00000023  00000000  00000000  000002ff  2**0
</span><span class='line'>              CONTENTS, RELOC, READONLY, DEBUGGING
</span><span class='line'>  9 .debug_pubtypes 00000012  00000000  00000000  00000322  2**0
</span><span class='line'>              CONTENTS, RELOC, READONLY, DEBUGGING
</span><span class='line'> 10 .debug_aranges 00000020  00000000  00000000  00000334  2**0
</span><span class='line'>              CONTENTS, RELOC, READONLY, DEBUGGING
</span><span class='line'> 11 .debug_str    000000b0  00000000  00000000  00000354  2**0
</span><span class='line'>              CONTENTS, READONLY, DEBUGGING
</span><span class='line'> 12 .comment      0000002b  00000000  00000000  00000404  2**0
</span><span class='line'>              CONTENTS, READONLY
</span><span class='line'> 13 .note.GNU-stack 00000000  00000000  00000000  0000042f  2**0
</span><span class='line'>              CONTENTS, READONLY
</span><span class='line'> 14 .debug_frame  00000054  00000000  00000000  00000430  2**2
</span><span class='line'>              CONTENTS, RELOC, READONLY, DEBUGGING</span></code></pre></td></tr></table></div></figure>


<p>All of the sections with naming debug_xxx are debugging information sections.  Information in these sections is interpreted by source debugger like gdb.  Each debug_ section holds specific information like</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>.debug_info               core DWARF data containing DIEs
</span><span class='line'>.debug_line               Line Number Program
</span><span class='line'>.debug_frame              Call Frame Information
</span><span class='line'>.debug_macinfo            lookup table for global objects and functions
</span><span class='line'>.debug_pubnames           lookup table for global objects and functions
</span><span class='line'>.debug_pubtypes           lookup table for global types
</span><span class='line'>.debug_loc                Macro descriptions
</span><span class='line'>.debug_abbrev             Abbreviations used in the .debug_info section
</span><span class='line'>.debug_aranges            mapping between memory address and compilation
</span><span class='line'>.debug_ranges             Address ranges referenced by DIEs
</span><span class='line'>.debug_str                String table used by .debug_info</span></code></pre></td></tr></table></div></figure>


<p>Debugging Information Entry (DIE)</p>

<p>Dwarf format organizes debug data in all of the above sections using special objects (program descriptive entities) called Debugging Information Entry (DIE).  Each DIE has a tag filed whose value specifies its type, and a set of attributes. DIEs are interlinked via sibling and child links, and values of attributes can point at other DIEs. Now let’s dig into ELF file to view how a DIE looks like. We will begin our exploration with .debug_info section of the ELF file since core DIE’s are listed in it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@techveda:~# objdump --dwarf=info . /sample
</span><span class='line'>
</span><span class='line'>Above operation shows long list of DIE’s. Let’s limit ourselves to relevant information
</span><span class='line'>
</span><span class='line'>./sample:     file format elf32-i386
</span><span class='line'> 
</span><span class='line'>Contents of the .debug_info section:
</span><span class='line'> 
</span><span class='line'>  Compilation Unit @ offset 0x0:
</span><span class='line'>   Length:        0x110 (32-bit)
</span><span class='line'>   Version:       2
</span><span class='line'>   Abbrev Offset: 0
</span><span class='line'>   Pointer Size:  4
</span><span class='line'> &lt;0&gt;&lt;b&gt;: Abbrev Number: 1 (DW_TAG_compile_unit)
</span><span class='line'>    &lt; c&gt;   DW_AT_producer    : (indirect string, offset: 0xe): GNU C 4.5.2   
</span><span class='line'>    &lt;10&gt;   DW_AT_language    : 1  (ANSI C)
</span><span class='line'>    &lt;11&gt;   DW_AT_name        : (indirect string, offset: 0x44): sample.c 
</span><span class='line'>    &lt;15&gt;   DW_AT_comp_dir    : (indirect string, offset: 0x71): /root
</span><span class='line'>    &lt;19&gt;   DW_AT_low_pc      : 0x80483c4 
</span><span class='line'>    &lt;1d&gt;   DW_AT_high_pc     : 0x8048423 
</span><span class='line'>    &lt;21&gt;   DW_AT_stmt_list   : 0x0</span></code></pre></td></tr></table></div></figure>


<p>Each source file in the application is referred in dwarf terminology as a “compilation unit”.   Dwarf data for each compilation unit (source file) starts with a compilation unit DIE. Above dump shows the first DIE’s and tag value “DW_TAG_compile_unit “.  This DIE provides general information about compilation unit like source file name (DW_AT_name   : (indirect string, offset: 0×44): sample.c),  high level programming language used to write source file(DW_AT_language    : 1    (ANSI C))  ,   directory of the source file(DW_AT_comp_dir    : (indirect string, offset: 0×71): /root) ,  compiler and producer of dwarf data(  DW_AT_producer    : (indirect string, offset: 0xe): GNU C 4.5.2) , start virtual address of the compilation unit  (DW_AT_low_pc      : 0x80483c4), end virtual address of the unit (DW_AT_high_pc     : 0×8048423).</p>

<p>Compilation Unit DIE is the parent for all the other DIE’s that describe elements of source file. Generally, the list of DIE’s that follow will describe data types, followed by global data, then the functions that make up the source file. The DIEs for variables and functions are in the same order in which they appear in the source file.</p>

<p>How does debugger locate Function Information ?</p>

<p> While using source debuggers we often instruct debugger to insert or place break point at some function, expecting the debugger to pause program execution at functions. To be able to perform this task, debugger must have some mapping between a function name in the high-level code and the address in the machine code where the instructions for this function begin. For this mapping information debuggers rely on DIE’s that describes specified function. DIE’s describing functions in a compilation unit are assigned tag value “DW_TAG_subprogram” subprogram as per dwarf terminology is a function.</p>

<p>In our sample application source we have two functions (main, add), dwarf should generate a “DW_TAG_subprogram” DIE’s for each function, these DIE attributes would define function mapping information that debugger needs for resolving machine code addresses with function name.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Each “DW_TAG_subprogam” DIE contains
</span><span class='line'>
</span><span class='line'>    function scope
</span><span class='line'>    function name
</span><span class='line'>    source file or compilation unit in which function is located
</span><span class='line'>     line no in the source file where the function starts
</span><span class='line'>    Functions return type
</span><span class='line'>    Start address of the fucntion
</span><span class='line'>    End address of the function
</span><span class='line'>    Frame information of the function.</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@techveda:~# objdump --dwarf=info ./sample | grep "DW_TAG_subprogram"
</span><span class='line'> &lt;1&gt;&lt;72&gt;: Abbrev Number: 4 (DW_TAG_subprogram)
</span><span class='line'> &lt;1&gt;&lt;a8&gt;: Abbrev Number: 6 (DW_TAG_subprogram)
</span><span class='line'> 
</span><span class='line'>&lt;1&gt;&lt;72&gt;: Abbrev Number: 4 (DW_TAG_subprogram)
</span><span class='line'>    &lt;73&gt;   DW_AT_external    : 1 
</span><span class='line'>    &lt;74&gt;   DW_AT_name        : add   
</span><span class='line'>    &lt;78&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;79&gt;   DW_AT_decl_line   : 4 
</span><span class='line'>    &lt;7a&gt;   DW_AT_prototyped  : 1 
</span><span class='line'>    &lt;7b&gt;   DW_AT_type        : &lt;0x4f&gt;  
</span><span class='line'>    &lt;7f&gt;   DW_AT_low_pc      : 0x80483c4 
</span><span class='line'>    &lt;83&gt;   DW_AT_high_pc     : 0x80483d1 
</span><span class='line'>    &lt;87&gt;   DW_AT_frame_base  : 0x0    (location list)
</span><span class='line'>    &lt;8b&gt;   DW_AT_sibling     : &lt;0xa8&gt;  
</span><span class='line'> 
</span><span class='line'>&lt;1&gt;&lt;a8&gt;: Abbrev Number: 6 (DW_TAG_subprogram)
</span><span class='line'>    &lt;a9&gt;   DW_AT_external    : 1 
</span><span class='line'>    &lt;aa&gt;   DW_AT_name        : (indirect string, offset: 0x1a): main 
</span><span class='line'>    &lt;ae&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;af&gt;   DW_AT_decl_line   : 8 
</span><span class='line'>    &lt;b0&gt;   DW_AT_type        : &lt;0x4f&gt;  
</span><span class='line'>    &lt;b4&gt;   DW_AT_low_pc      : 0x80483d2 
</span><span class='line'>    &lt;b8&gt;   DW_AT_high_pc     : 0x8048423 
</span><span class='line'>    &lt;bc&gt;   DW_AT_frame_base  : 0x38   (location list)
</span><span class='line'>    &lt;c0&gt;   DW_AT_sibling     : &lt;0xf8&gt;</span></code></pre></td></tr></table></div></figure>


<p>We now have accessed DIE description of function’s main and add.  Let’s analyze attribute information of add fucntions DIE.</p>

<p>Function scope:    DW_AT_external    : 1 (scope external)</p>

<p>Function name:     DW_AT_name        : add</p>

<p>Source file or compilation unit in which function is located:  DW_AT_decl_file   : 1 (indicates 1st compilation unit which is sample.c)</p>

<p>line no in the source file where the function starts:  DW_AT_decl_line   : 4 ( indicates line no 4 in source file)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1#include &lt;stdio.h&gt;
</span><span class='line'>2#include &lt;stdlib.h&gt;
</span><span class='line'>3 
</span><span class='line'>4int add(int x, int y)
</span><span class='line'>5{
</span><span class='line'>6        return x + y;
</span><span class='line'>7}
</span><span class='line'>8int main()
</span><span class='line'>9{
</span><span class='line'>10        int a = 10, b = 20;
</span><span class='line'>11        int result;
</span><span class='line'>12        int (*fp) (int, int);
</span><span class='line'>13 
</span><span class='line'>14        fp = add;
</span><span class='line'>15        result = (*fp) (a, b);
</span><span class='line'>16        printf(" %dn", result);
</span><span class='line'>17}</span></code></pre></td></tr></table></div></figure>


<p>Function’s source line no matched with DIE description of line no. let’s continue with rest of the attribute values</p>

<p>Functions return type:  DW_AT_type        : <0x4f></p>

<p>As we have already understood that values of attributes can point to other DIE , here is an example of it.  Value   DW_AT_type     : <0x4f> indicates that return type description is stored in other DIE at offset 0x4f.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;4f&gt;: Abbrev Number: 3 (DW_TAG_base_type)
</span><span class='line'>    &lt;50&gt;   DW_AT_byte_size   : 4 
</span><span class='line'>    &lt;51&gt;   DW_AT_encoding    : 5  (signed)
</span><span class='line'>    &lt;52&gt;   DW_AT_name        : int</span></code></pre></td></tr></table></div></figure>


<p>This DIE describes data type and composition of return type of the function add, as per DIE attribute values return type is signed int  of size 4 bytes.</p>

<p>Start address of the function : DW_AT_low_pc   : 0x80483c4</p>

<p>End address of the function: DW_AT_high_pc     : 0x80483d1</p>

<p>Above values indicate start and end virtual address of the machine instructions of add function, we can verify that with binary dump of the function</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>080483c4 &lt;add&gt;:
</span><span class='line'> 80483c4:   55                      push   %ebp
</span><span class='line'> 80483c5:   89 e5                   mov    %esp,%ebp
</span><span class='line'> 80483c7:   8b 45 0c                mov    0xc(%ebp),%eax
</span><span class='line'> 80483ca:   8b 55 08                mov    0x8(%ebp),%edx
</span><span class='line'> 80483cd:   8d 04 02                lea    (%edx,%eax,1),%eax
</span><span class='line'> 80483d0:   5d                      pop    %ebp
</span><span class='line'> 80483d1:   c3                      ret</span></code></pre></td></tr></table></div></figure>


<p>How does debugger find program data (variables…) Information?</p>

<p>When the program hits assigned break point in a function, debugger pauses the program execution, at this time we can instruct debugger to show or print values of variables, by using debugger commands like print or display followed by variable name (ex: print a) How does debugger know where to find memory location of the variable ? Variables can be located in global storage, on the stack, and even in registers.The debugging information has to be able to reflect all these variations, and indeed DWARF does. As an example let’s take a look at complete DIE information set for main function.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;1&gt;&lt;a8&gt;: Abbrev Number: 6 (DW_TAG_subprogram)
</span><span class='line'>    &lt;a9&gt;   DW_AT_external    : 1 
</span><span class='line'>    &lt;aa&gt;   DW_AT_name        : (indirect string, offset: 0x1a): main 
</span><span class='line'>    &lt;ae&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;af&gt;   DW_AT_decl_line   : 8 
</span><span class='line'>    &lt;b0&gt;   DW_AT_type        : &lt;0x4f&gt;  
</span><span class='line'>    &lt;b4&gt;   DW_AT_low_pc      : 0x80483d2 
</span><span class='line'>    &lt;b8&gt;   DW_AT_high_pc     : 0x8048423 
</span><span class='line'>    &lt;bc&gt;   DW_AT_frame_base  : 0x38   (location list)
</span><span class='line'>    &lt;c0&gt;   DW_AT_sibling     : &lt;0xf8&gt;  
</span><span class='line'> &lt;2&gt;&lt;c4&gt;: Abbrev Number: 7 (DW_TAG_variable)
</span><span class='line'>    &lt;c5&gt;   DW_AT_name        : a 
</span><span class='line'>    &lt;c7&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;c8&gt;   DW_AT_decl_line   : 10
</span><span class='line'>    &lt;c9&gt;   DW_AT_type        : &lt;0x4f&gt;  
</span><span class='line'>    &lt;cd&gt;   DW_AT_location    : 2 byte block: 74 1c    (DW_OP_breg4 (esp): 28)
</span><span class='line'> &lt;2&gt;&lt;d0&gt;: Abbrev Number: 7 (DW_TAG_variable)
</span><span class='line'>    &lt;d1&gt;   DW_AT_name        : b 
</span><span class='line'>    &lt;d3&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;d4&gt;   DW_AT_decl_line   : 10
</span><span class='line'>    &lt;d5&gt;   DW_AT_type        : &lt;0x4f&gt;  
</span><span class='line'>    &lt;d9&gt;   DW_AT_location    : 2 byte block: 74 18    (DW_OP_breg4 (esp): 24)
</span><span class='line'> &lt;2&gt;&lt;dc&gt;: Abbrev Number: 8 (DW_TAG_variable)
</span><span class='line'>    &lt;dd&gt;           : (indirect string, offset: 0x6a): result 
</span><span class='line'>    &lt;e1&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;e2&gt;   DW_AT_decl_line   : 11
</span><span class='line'>    &lt;e3&gt;   DW_AT_type        : &lt;0x4f&gt;  
</span><span class='line'>    &lt;e7&gt;   DW_AT_location    : 2 byte block: 74 10    (DW_OP_breg4 (esp): 16)
</span><span class='line'> &lt;2&gt;&lt;ea&gt;: Abbrev Number: 7 (DW_TAG_variable)
</span><span class='line'>    &lt;eb&gt;   DW_AT_name        : fp
</span><span class='line'>    &lt;ee&gt;   DW_AT_decl_file   : 1 
</span><span class='line'>    &lt;ef&gt;   DW_AT_decl_line   : 12
</span><span class='line'>    &lt;f0&gt;   DW_AT_type        : &lt;0x10d&gt; 
</span><span class='line'>    &lt;f4&gt;   DW_AT_location    : 2 byte block: 74 14    (DW_OP_breg4 (esp): 20)</span></code></pre></td></tr></table></div></figure>


<p>Note the first number inside the angle brackets in each entry. This is the nesting level – in this example entries with <2> are children of the entry with <1>. main function has three integer variables a,b and result each of these variables are described with DW_TAG_variable nested DIE’s (0xc4, 0xd0, 0xdc). main function also has a function pointer  fp described  in DIE 0xea . Variable DIE attributes specify variable name (DW_AT_name), declaration line no in source function (DW_AT_decl_line ), pointer to address of DIE describing variables data type (DW_AT_type) and relative location of the variable within function’s frame (DW_AT_location).</p>

<p>To locate the variable in the memory image of the executing process, the debugger will look at the DW_AT_location attribute of DIE. For a its value is    DW_OP_fbreg4 (esp):28. This means that the variable is stored at offset 28  from the top in the frame of  containing function. The DW_AT_frame_base attribute of main has the value 0×38(location list), which means that this value actually has to be looked up in the location list section. Let’s look at it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@techveda:~# objdump --dwarf=loc sample
</span><span class='line'> 
</span><span class='line'>sample:     file format elf32-i386
</span><span class='line'> 
</span><span class='line'>Contents of the .debug_loc section:
</span><span class='line'> 
</span><span class='line'>    Offset   Begin    End      Expression
</span><span class='line'>    00000000 080483c4 080483c5 (DW_OP_breg4 (esp): 4)
</span><span class='line'>    00000000 080483c5 080483c7 (DW_OP_breg4 (esp): 8)
</span><span class='line'>    00000000 080483c7 080483d1 (DW_OP_breg5 (ebp): 8)
</span><span class='line'>    00000000 080483d1 080483d2 (DW_OP_breg4 (esp): 4)
</span><span class='line'>    00000000 &lt;End of list&gt;
</span><span class='line'>    00000038 080483d2 080483d3 (DW_OP_breg4 (esp): 4)
</span><span class='line'>    00000038 080483d3 080483d5 (DW_OP_breg4 (esp): 8)
</span><span class='line'>    00000038 080483d5 08048422 (DW_OP_breg5 (ebp): 8)
</span><span class='line'>    00000038 08048422 08048423 (DW_OP_breg4 (esp): 4)
</span><span class='line'>    00000038 &lt;End of list&gt;</span></code></pre></td></tr></table></div></figure>


<p>Offset column 0×38 values are the entries for main function variables. Each entry here describes possible frame base address with respect to where debugger may be paused by break point within function instructions; it specifies the current frame base from which offsets to variables are to be computed as an offset from a register. For x86, bpreg4 refers to esp and bpreg5 refers to ebp.  Before analyzing further lets look at disassemble dump for main function</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>080483d2 &lt;main&gt;:
</span><span class='line'> 80483d2:   55                      push   %ebp
</span><span class='line'> 80483d3:   89 e5                   mov    %esp,%ebp
</span><span class='line'> 80483d5:   83 e4 f0                and    $0xfffffff0,%esp
</span><span class='line'> 80483d8:   83 ec 20                sub    $0x20,%esp
</span><span class='line'> 80483db:   c7 44 24 1c 0a 00 00    movl   $0xa,0x1c(%esp)
</span><span class='line'> 80483e2:   00
</span><span class='line'> 80483e3:   c7 44 24 18 14 00 00    movl   $0x14,0x18(%esp)
</span><span class='line'> 80483ea:   00
</span><span class='line'> 80483eb:   c7 44 24 14 c4 83 04    movl   $0x80483c4,0x14(%esp)
</span><span class='line'> 80483f2:   08
</span><span class='line'> 80483f3:   8b 44 24 18             mov    0x18(%esp),%eax
</span><span class='line'> 80483f7:   89 44 24 04             mov    %eax,0x4(%esp)
</span><span class='line'> 80483fb:   8b 44 24 1c             mov    0x1c(%esp),%eax
</span><span class='line'> 80483ff:   89 04 24                mov    %eax,(%esp)
</span><span class='line'> 8048402:   8b 44 24 14             mov    0x14(%esp),%eax
</span><span class='line'> 8048406:   ff d0                               call   *%eax
</span><span class='line'> 8048408:   89 44 24 10             mov    %eax,0x10(%esp)
</span><span class='line'> 804840c:   b8 f0 84 04 08          mov    $0x80484f0,%eax
</span><span class='line'> 8048411:   8b 54 24 10             mov    0x10(%esp),%edx
</span><span class='line'> 8048415:   89 54 24 04             mov    %edx,0x4(%esp)
</span><span class='line'> 8048419:   89 04 24                mov    %eax,(%esp)
</span><span class='line'> 804841c:   e8 d3 fe ff ff          call   80482f4 &lt;printf@plt&gt;
</span><span class='line'> 8048421:   c9                      leave 
</span><span class='line'> 8048422:   c3                      ret</span></code></pre></td></tr></table></div></figure>


<p>First two instructions deal with function’s preamble, function’s stack frame base pointer is determined after pre-amble instructions are executed.  Ebp remains constant throughout function’s execution and esp keeps changing with data being pushed and popped from the stack frame. From the above dump instructions at offset 80483db and 80483e3 are assigning values 10 and 20 to variables a, and b. These variables are being accessed their offset in stack frame relative to location of current esp( variable a: 0x1c(%esp), variable b: 0×18(%esp)). Now let’s assume that break point was set after initializing a and b variables and program paused, and we have run print command to view conents of a or b variables. Debugger would access 3rd record of the main function’s dwarf debug.loc table since our break point falls between 080483d5 – 08048422 region of the function code.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>00000038 080483d2 080483d3 (DW_OP_breg4 (esp): 4)
</span><span class='line'>00000038 080483d3 080483d5 (DW_OP_breg4 (esp): 8)
</span><span class='line'>00000038 080483d5 08048422 (DW_OP_breg5 (ebp): 8)--- 3rd record
</span><span class='line'>00000038 08048422 08048423 (DW_OP_breg4 (esp): 4)</span></code></pre></td></tr></table></div></figure>


<p>Now as per records debugger will locate a with esp + 28 , b with esp +24 and so on…</p>

<p>Looking up line number information</p>

<p>We can set breakpoints mentioning line no’s Lets now look at how debuggers resolve line no’s to machine instruction’s? DWARF encodes a full mapping between lines in the C source code and machine code addresses in the executable. This information is contained in the .debug_line section and can be extracted using objdump</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@techveda:~# objdump --dwarf=decodedline ./sample
</span><span class='line'> 
</span><span class='line'>./sample:     file format elf32-i386
</span><span class='line'> 
</span><span class='line'>Decoded dump of debug contents of section .debug_line:
</span><span class='line'> 
</span><span class='line'>CU: sample.c:
</span><span class='line'>File name                            Line number    Starting address                   
</span><span class='line'>sample.c                                       5          0x80483c4
</span><span class='line'>sample.c                                       6          0x80483c7
</span><span class='line'>sample.c                                       7          0x80483d0
</span><span class='line'>sample.c                                       9          0x80483d2
</span><span class='line'>sample.c                                      10          0x80483db
</span><span class='line'>sample.c                                      14          0x80483eb
</span><span class='line'>sample.c                                      15          0x80483f3
</span><span class='line'>sample.c                                      16          0x804840c
</span><span class='line'>sample.c                                      17          0x8048421</span></code></pre></td></tr></table></div></figure>


<p>This dump shows machine instruction line no’s for our program. It is quite obvious that line no’s for non-executable statements of the source file need not be tracked by dwarf .we can map the above dump to our source code for analysis.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1 #include &lt;stdio.h&gt;
</span><span class='line'> 2 #include &lt;stdlib.h&gt;
</span><span class='line'> 3
</span><span class='line'> 4 int add(int x, int y)
</span><span class='line'> 5 {
</span><span class='line'> 6         return x + y;
</span><span class='line'> 7 }
</span><span class='line'> 8 int main()
</span><span class='line'> 9 {
</span><span class='line'>10         int a = 10, b = 20;
</span><span class='line'>11         int result;
</span><span class='line'>12         int (*fp) (int, int);
</span><span class='line'>13
</span><span class='line'>14         fp = add;
</span><span class='line'>15         result = (*fp) (a, b);
</span><span class='line'>16         printf(" %dn", result);
</span><span class='line'>17 }</span></code></pre></td></tr></table></div></figure>


<p>From the above it should be clear of what debugger does it is instructed to set breakpoint at entry into function add, it would insert break point at line no 6 and pause after pre-amble of function add is executed.</p>

<p>What’s next?</p>

<p>if you are into implementation of debugging tools or involved in writing programs/tools  that simulate debugger facilities/ read binary files , you may be interested in specific programming libraries libbfd or libdwarf.</p>

<p>Binary File Descriptor library (BFD) or libbfd as it is called provides ready to use functions to read into ELF and other popular binary files. BFD works by presenting a common abstract view of object files. An object file has a “header” with descriptive info; a variable number of “sections” that each has a name, some attributes, and a block of data; a symbol table; relocation entries; and so forth. Gnu binutils package tools like objdump, readelf and others have been written using these libraries.</p>

<p>Libdwarf is a C library intended to simplify reading (and writing) applications built with DWARF2, DWARF3 debug information.</p>

<p>Dwarfdump is an application written using libdwarf to print dwarf information in a human readable format. It is also open sourced and is copyrighted GPL. It provides an example of using libdwarf to read DWARF2/3 information as well as providing readable text output.</p>

<p>References</p>

<p><a href="http://www.dwarfstd.org/">Dwarf Standard</a><br/>
<a href="http://wiki.dwarfstd.org/index.php?title=Libdwarf_And_Dwarfdump">Libdwarf Wiki</a><br/>
<a href="http://www.skyfree.org/linux/references/bfd.pdf">Libbfd draft</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/67">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/65">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<h1>Categories</h1>
<head>
</head>
<body>
<div id="menu">
<ul>
<li class='catclass'><a href='/blog/cats/language/'>language</a><a href='##' onmousedown=showDiv('language') id='aexp_language'><span class='exp_style' id='exp_language'>[+]</span></a><span class='right_span'>(40)</span></li>
<div id='language' class='catsub'><li><a href='/blog/cats/language~c/?opendiv=language'>c</a><a href='##' onmousedown=showDiv('language~c') id='aexp_language~c'><span class='exp_style' id='exp_language~c'>[+]</span></a><span class='right_span'>23</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('language~c')) document.getElementById('aexp_language~c').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/language~java/?opendiv=language'>java</a><a href='##' onmousedown=showDiv('language~java') id='aexp_language~java'><span class='exp_style' id='exp_language~java'>[+]</span></a><span class='right_span'>11</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('language~java')) document.getElementById('aexp_language~java').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/language~web/?opendiv=language'>web</a><a href='##' onmousedown=showDiv('language~web') id='aexp_language~web'><span class='exp_style' id='exp_language~web'>[+]</span></a><span class='right_span'>6</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('language')) document.getElementById('aexp_language').style.visibility = 'hidden';
if (!document.getElementById('language~web')) document.getElementById('aexp_language~web').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/compiler/'>compiler</a><a href='##' onmousedown=showDiv('compiler') id='aexp_compiler'><span class='exp_style' id='exp_compiler'>[+]</span></a><span class='right_span'>(14)</span></li>
<div id='compiler' class='catsub'><li><a href='/blog/cats/compiler~base/?opendiv=compiler'>base</a><a href='##' onmousedown=showDiv('compiler~base') id='aexp_compiler~base'><span class='exp_style' id='exp_compiler~base'>[+]</span></a><span class='right_span'>10</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('compiler~base')) document.getElementById('aexp_compiler~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/compiler~make/?opendiv=compiler'>make</a><a href='##' onmousedown=showDiv('compiler~make') id='aexp_compiler~make'><span class='exp_style' id='exp_compiler~make'>[+]</span></a><span class='right_span'>4</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('compiler')) document.getElementById('aexp_compiler').style.visibility = 'hidden';
if (!document.getElementById('compiler~make')) document.getElementById('aexp_compiler~make').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/assembly/'>assembly</a><a href='##' onmousedown=showDiv('assembly') id='aexp_assembly'><span class='exp_style' id='exp_assembly'>[+]</span></a><span class='right_span'>(15)</span></li>
<div id='assembly' class='catsub'><li><a href='/blog/cats/assembly~arm/?opendiv=assembly'>arm</a><a href='##' onmousedown=showDiv('assembly~arm') id='aexp_assembly~arm'><span class='exp_style' id='exp_assembly~arm'>[+]</span></a><span class='right_span'>2</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('assembly~arm')) document.getElementById('aexp_assembly~arm').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/assembly~base/?opendiv=assembly'>base</a><a href='##' onmousedown=showDiv('assembly~base') id='aexp_assembly~base'><span class='exp_style' id='exp_assembly~base'>[+]</span></a><span class='right_span'>13</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('assembly')) document.getElementById('aexp_assembly').style.visibility = 'hidden';
if (!document.getElementById('assembly~base')) document.getElementById('aexp_assembly~base').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/tools/'>tools</a><a href='##' onmousedown=showDiv('tools') id='aexp_tools'><span class='exp_style' id='exp_tools'>[+]</span></a><span class='right_span'>(51)</span></li>
<div id='tools' class='catsub'><li><a href='/blog/cats/tools~base/?opendiv=tools'>base</a><a href='##' onmousedown=showDiv('tools~base') id='aexp_tools~base'><span class='exp_style' id='exp_tools~base'>[+]</span></a><span class='right_span'>13</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~base')) document.getElementById('aexp_tools~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~ci/?opendiv=tools'>ci</a><a href='##' onmousedown=showDiv('tools~ci') id='aexp_tools~ci'><span class='exp_style' id='exp_tools~ci'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~ci')) document.getElementById('aexp_tools~ci').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~command/?opendiv=tools'>command</a><a href='##' onmousedown=showDiv('tools~command') id='aexp_tools~command'><span class='exp_style' id='exp_tools~command'>[+]</span></a><span class='right_span'>11</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~command')) document.getElementById('aexp_tools~command').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~git/?opendiv=tools'>git</a><a href='##' onmousedown=showDiv('tools~git') id='aexp_tools~git'><span class='exp_style' id='exp_tools~git'>[+]</span></a><span class='right_span'>6</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~git')) document.getElementById('aexp_tools~git').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~haproxy/?opendiv=tools'>haproxy</a><a href='##' onmousedown=showDiv('tools~haproxy') id='aexp_tools~haproxy'><span class='exp_style' id='exp_tools~haproxy'>[+]</span></a><span class='right_span'>9</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~haproxy')) document.getElementById('aexp_tools~haproxy').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~mysql/?opendiv=tools'>mysql</a><a href='##' onmousedown=showDiv('tools~mysql') id='aexp_tools~mysql'><span class='exp_style' id='exp_tools~mysql'>[+]</span></a><span class='right_span'>6</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~mysql')) document.getElementById('aexp_tools~mysql').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~ssh/?opendiv=tools'>ssh</a><a href='##' onmousedown=showDiv('tools~ssh') id='aexp_tools~ssh'><span class='exp_style' id='exp_tools~ssh'>[+]</span></a><span class='right_span'>3</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('tools')) document.getElementById('aexp_tools').style.visibility = 'hidden';
if (!document.getElementById('tools~ssh')) document.getElementById('aexp_tools~ssh').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/system/'>system</a><a href='##' onmousedown=showDiv('system') id='aexp_system'><span class='exp_style' id='exp_system'>[+]</span></a><span class='right_span'>(54)</span></li>
<div id='system' class='catsub'><li><a href='/blog/cats/system~base/?opendiv=system'>base</a><a href='##' onmousedown=showDiv('system~base') id='aexp_system~base'><span class='exp_style' id='exp_system~base'>[+]</span></a><span class='right_span'>17</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~base')) document.getElementById('aexp_system~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~centos/?opendiv=system'>centos</a><a href='##' onmousedown=showDiv('system~centos') id='aexp_system~centos'><span class='exp_style' id='exp_system~centos'>[+]</span></a><span class='right_span'>8</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~centos')) document.getElementById('aexp_system~centos').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~cgroup/?opendiv=system'>cgroup</a><a href='##' onmousedown=showDiv('system~cgroup') id='aexp_system~cgroup'><span class='exp_style' id='exp_system~cgroup'>[+]</span></a><span class='right_span'>11</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~cgroup')) document.getElementById('aexp_system~cgroup').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~kvm/?opendiv=system'>kvm</a><a href='##' onmousedown=showDiv('system~kvm') id='aexp_system~kvm'><span class='exp_style' id='exp_system~kvm'>[+]</span></a><span class='right_span'>7</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~kvm')) document.getElementById('aexp_system~kvm').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~namespace/?opendiv=system'>namespace</a><a href='##' onmousedown=showDiv('system~namespace') id='aexp_system~namespace'><span class='exp_style' id='exp_system~namespace'>[+]</span></a><span class='right_span'>2</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~namespace')) document.getElementById('aexp_system~namespace').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~ubuntu/?opendiv=system'>ubuntu</a><a href='##' onmousedown=showDiv('system~ubuntu') id='aexp_system~ubuntu'><span class='exp_style' id='exp_system~ubuntu'>[+]</span></a><span class='right_span'>9</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('system')) document.getElementById('aexp_system').style.visibility = 'hidden';
if (!document.getElementById('system~ubuntu')) document.getElementById('aexp_system~ubuntu').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/kernel/'>kernel</a><a href='##' onmousedown=showDiv('kernel') id='aexp_kernel'><span class='exp_style' id='exp_kernel'>[+]</span></a><span class='right_span'>(161)</span></li>
<div id='kernel' class='catsub'><li><a href='/blog/cats/kernel~base/?opendiv=kernel'>base</a><a href='##' onmousedown=showDiv('kernel~base') id='aexp_kernel~base'><span class='exp_style' id='exp_kernel~base'>[+]</span></a><span class='right_span'>19</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~base')) document.getElementById('aexp_kernel~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~fs/?opendiv=kernel'>fs</a><a href='##' onmousedown=showDiv('kernel~fs') id='aexp_kernel~fs'><span class='exp_style' id='exp_kernel~fs'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~fs')) document.getElementById('aexp_kernel~fs').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~irq/?opendiv=kernel'>irq</a><a href='##' onmousedown=showDiv('kernel~irq') id='aexp_kernel~irq'><span class='exp_style' id='exp_kernel~irq'>[+]</span></a><span class='right_span'>10</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~irq')) document.getElementById('aexp_kernel~irq').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~kexec/?opendiv=kernel'>kexec</a><a href='##' onmousedown=showDiv('kernel~kexec') id='aexp_kernel~kexec'><span class='exp_style' id='exp_kernel~kexec'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~kexec')) document.getElementById('aexp_kernel~kexec').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~mm/?opendiv=kernel'>mm</a><a href='##' onmousedown=showDiv('kernel~mm') id='aexp_kernel~mm'><span class='exp_style' id='exp_kernel~mm'>[+]</span></a><span class='right_span'>33</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~mm')) document.getElementById('aexp_kernel~mm').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~net/?opendiv=kernel'>net</a><a href='##' onmousedown=showDiv('kernel~net') id='aexp_kernel~net'><span class='exp_style' id='exp_kernel~net'>[+]</span></a><span class='right_span'>78</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~net')) document.getElementById('aexp_kernel~net').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~sched/?opendiv=kernel'>sched</a><a href='##' onmousedown=showDiv('kernel~sched') id='aexp_kernel~sched'><span class='exp_style' id='exp_kernel~sched'>[+]</span></a><span class='right_span'>19</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel')) document.getElementById('aexp_kernel').style.visibility = 'hidden';
if (!document.getElementById('kernel~sched')) document.getElementById('aexp_kernel~sched').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/android/'>android</a><a href='##' onmousedown=showDiv('android') id='aexp_android'><span class='exp_style' id='exp_android'>[+]</span></a><span class='right_span'>(22)</span></li>
<div id='android' class='catsub'><li><a href='/blog/cats/android~base/?opendiv=android'>base</a><a href='##' onmousedown=showDiv('android~base') id='aexp_android~base'><span class='exp_style' id='exp_android~base'>[+]</span></a><span class='right_span'>13</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~base')) document.getElementById('aexp_android~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~i9507v/?opendiv=android'>i9507v</a><a href='##' onmousedown=showDiv('android~i9507v') id='aexp_android~i9507v'><span class='exp_style' id='exp_android~i9507v'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~i9507v')) document.getElementById('aexp_android~i9507v').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~me722/?opendiv=android'>me722</a><a href='##' onmousedown=showDiv('android~me722') id='aexp_android~me722'><span class='exp_style' id='exp_android~me722'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~me722')) document.getElementById('aexp_android~me722').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~nx403a/?opendiv=android'>nx403a</a><a href='##' onmousedown=showDiv('android~nx403a') id='aexp_android~nx403a'><span class='exp_style' id='exp_android~nx403a'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~nx403a')) document.getElementById('aexp_android~nx403a').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~s5830/?opendiv=android'>s5830</a><a href='##' onmousedown=showDiv('android~s5830') id='aexp_android~s5830'><span class='exp_style' id='exp_android~s5830'>[+]</span></a><span class='right_span'>2</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('android')) document.getElementById('aexp_android').style.visibility = 'hidden';
if (!document.getElementById('android~s5830')) document.getElementById('aexp_android~s5830').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/debug/'>debug</a><a href='##' onmousedown=showDiv('debug') id='aexp_debug'><span class='exp_style' id='exp_debug'>[+]</span></a><span class='right_span'>(70)</span></li>
<div id='debug' class='catsub'><li><a href='/blog/cats/debug~base/?opendiv=debug'>base</a><a href='##' onmousedown=showDiv('debug~base') id='aexp_debug~base'><span class='exp_style' id='exp_debug~base'>[+]</span></a><span class='right_span'>18</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~base')) document.getElementById('aexp_debug~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~dwarf/?opendiv=debug'>dwarf</a><a href='##' onmousedown=showDiv('debug~dwarf') id='aexp_debug~dwarf'><span class='exp_style' id='exp_debug~dwarf'>[+]</span></a><span class='right_span'>4</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~dwarf')) document.getElementById('aexp_debug~dwarf').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~gdb/?opendiv=debug'>gdb</a><a href='##' onmousedown=showDiv('debug~gdb') id='aexp_debug~gdb'><span class='exp_style' id='exp_debug~gdb'>[+]</span></a><span class='right_span'>8</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~gdb')) document.getElementById('aexp_debug~gdb').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~kdump,-crash/?opendiv=debug'>kdump、crash</a><a href='##' onmousedown=showDiv('debug~kdump、crash') id='aexp_debug~kdump、crash'><span class='exp_style' id='exp_debug~kdump、crash'>[+]</span></a><span class='right_span'>10</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~kdump、crash')) document.getElementById('aexp_debug~kdump、crash').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~kgdb/?opendiv=debug'>kgdb</a><a href='##' onmousedown=showDiv('debug~kgdb') id='aexp_debug~kgdb'><span class='exp_style' id='exp_debug~kgdb'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~kgdb')) document.getElementById('aexp_debug~kgdb').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~kprobe/?opendiv=debug'>kprobe</a><a href='##' onmousedown=showDiv('debug~kprobe') id='aexp_debug~kprobe'><span class='exp_style' id='exp_debug~kprobe'>[+]</span></a><span class='right_span'>4</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~kprobe')) document.getElementById('aexp_debug~kprobe').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~mark/?opendiv=debug'>mark</a><a href='##' onmousedown=showDiv('debug~mark') id='aexp_debug~mark'><span class='exp_style' id='exp_debug~mark'>[+]</span></a><span class='right_span'>17</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~mark')) document.getElementById('aexp_debug~mark').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~perf/?opendiv=debug'>perf</a><a href='##' onmousedown=showDiv('debug~perf') id='aexp_debug~perf'><span class='exp_style' id='exp_debug~perf'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~perf')) document.getElementById('aexp_debug~perf').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~systemtap/?opendiv=debug'>systemtap</a><a href='##' onmousedown=showDiv('debug~systemtap') id='aexp_debug~systemtap'><span class='exp_style' id='exp_debug~systemtap'>[+]</span></a><span class='right_span'>5</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('debug')) document.getElementById('aexp_debug').style.visibility = 'hidden';
if (!document.getElementById('debug~systemtap')) document.getElementById('aexp_debug~systemtap').style.visibility = 'hidden';
</script>
<li><div style="background:#DDD; height:0.3em;"></div></li><li class='catclass'><a href='/blog/cats/algorithm/'>algorithm</a><a href='##' onmousedown=showDiv('algorithm') id='aexp_algorithm'><span class='exp_style' id='exp_algorithm'>[+]</span></a><span class='right_span'>(27)</span></li>
<div id='algorithm' class='catsub'><li><a href='/blog/cats/algorithm~base/?opendiv=algorithm'>base</a><a href='##' onmousedown=showDiv('algorithm~base') id='aexp_algorithm~base'><span class='exp_style' id='exp_algorithm~base'>[+]</span></a><span class='right_span'>20</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm~base')) document.getElementById('aexp_algorithm~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/algorithm~dp/?opendiv=algorithm'>dp</a><a href='##' onmousedown=showDiv('algorithm~dp') id='aexp_algorithm~dp'><span class='exp_style' id='exp_algorithm~dp'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm~dp')) document.getElementById('aexp_algorithm~dp').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/algorithm~ds/?opendiv=algorithm'>ds</a><a href='##' onmousedown=showDiv('algorithm~ds') id='aexp_algorithm~ds'><span class='exp_style' id='exp_algorithm~ds'>[+]</span></a><span class='right_span'>4</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm~ds')) document.getElementById('aexp_algorithm~ds').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/algorithm~tc/?opendiv=algorithm'>tc</a><a href='##' onmousedown=showDiv('algorithm~tc') id='aexp_algorithm~tc'><span class='exp_style' id='exp_algorithm~tc'>[+]</span></a><span class='right_span'>2</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm')) document.getElementById('aexp_algorithm').style.visibility = 'hidden';
if (!document.getElementById('algorithm~tc')) document.getElementById('aexp_algorithm~tc').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/blog/'>blog</a><a href='##' onmousedown=showDiv('blog') id='aexp_blog'><span class='exp_style' id='exp_blog'>[+]</span></a><span class='right_span'>(11)</span></li>
<div id='blog' class='catsub'><li><a href='/blog/cats/blog~hello/?opendiv=blog'>hello</a><a href='##' onmousedown=showDiv('blog~hello') id='aexp_blog~hello'><span class='exp_style' id='exp_blog~hello'>[+]</span></a><span class='right_span'>1</span></li>
<div id='blog~hello' class='catsub2'><li><a href='/blog/cats/blog~hello~hi/?opendiv=blog~hello'>hi</a><span class='right_span'>1</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~hello')) document.getElementById('aexp_blog~hello').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~jekyll/?opendiv=blog'>jekyll</a><a href='##' onmousedown=showDiv('blog~jekyll') id='aexp_blog~jekyll'><span class='exp_style' id='exp_blog~jekyll'>[+]</span></a><span class='right_span'>2</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~jekyll')) document.getElementById('aexp_blog~jekyll').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~markdown/?opendiv=blog'>markdown</a><a href='##' onmousedown=showDiv('blog~markdown') id='aexp_blog~markdown'><span class='exp_style' id='exp_blog~markdown'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~markdown')) document.getElementById('aexp_blog~markdown').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~octopress/?opendiv=blog'>octopress</a><a href='##' onmousedown=showDiv('blog~octopress') id='aexp_blog~octopress'><span class='exp_style' id='exp_blog~octopress'>[+]</span></a><span class='right_span'>5</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~octopress')) document.getElementById('aexp_blog~octopress').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~ruby/?opendiv=blog'>ruby</a><a href='##' onmousedown=showDiv('blog~ruby') id='aexp_blog~ruby'><span class='exp_style' id='exp_blog~ruby'>[+]</span></a><span class='right_span'>2</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('blog')) document.getElementById('aexp_blog').style.visibility = 'hidden';
if (!document.getElementById('blog~ruby')) document.getElementById('aexp_blog~ruby').style.visibility = 'hidden';
</script>

</ul>
</div>
</body>
</html>
</section>

<section>
<h1>Date Categories</h1>
<head>
</head>
<body>
<div id="menu">
<ul>
<li class='catclass'><a href='/blog/cats/2016/'>2016</a><a href='##' onmousedown=showDiv('2016')><span class='exp_style' id='exp_2016'>[+]</span></a><span class='right_span'>(7)</span></li>
<div id='2016' class='catsub'><li><a href='/blog/cats/2016~02/?opendiv=2016'>2016-02</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2016~01/?opendiv=2016'>2016-01</a><span class='right_span'>6</span></li>
</div><li class='catclass'><a href='/blog/cats/2015/'>2015</a><a href='##' onmousedown=showDiv('2015')><span class='exp_style' id='exp_2015'>[+]</span></a><span class='right_span'>(207)</span></li>
<div id='2015' class='catsub'><li><a href='/blog/cats/2015~12/?opendiv=2015'>2015-12</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2015~11/?opendiv=2015'>2015-11</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2015~10/?opendiv=2015'>2015-10</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2015~09/?opendiv=2015'>2015-09</a><span class='right_span'>18</span></li>
<li><a href='/blog/cats/2015~08/?opendiv=2015'>2015-08</a><span class='right_span'>25</span></li>
<li><a href='/blog/cats/2015~07/?opendiv=2015'>2015-07</a><span class='right_span'>31</span></li>
<li><a href='/blog/cats/2015~06/?opendiv=2015'>2015-06</a><span class='right_span'>24</span></li>
<li><a href='/blog/cats/2015~05/?opendiv=2015'>2015-05</a><span class='right_span'>22</span></li>
<li><a href='/blog/cats/2015~04/?opendiv=2015'>2015-04</a><span class='right_span'>23</span></li>
<li><a href='/blog/cats/2015~03/?opendiv=2015'>2015-03</a><span class='right_span'>19</span></li>
<li><a href='/blog/cats/2015~02/?opendiv=2015'>2015-02</a><span class='right_span'>11</span></li>
<li><a href='/blog/cats/2015~01/?opendiv=2015'>2015-01</a><span class='right_span'>19</span></li>
</div><li class='catclass'><a href='/blog/cats/2014/'>2014</a><a href='##' onmousedown=showDiv('2014')><span class='exp_style' id='exp_2014'>[+]</span></a><span class='right_span'>(112)</span></li>
<div id='2014' class='catsub'><li><a href='/blog/cats/2014~12/?opendiv=2014'>2014-12</a><span class='right_span'>21</span></li>
<li><a href='/blog/cats/2014~11/?opendiv=2014'>2014-11</a><span class='right_span'>19</span></li>
<li><a href='/blog/cats/2014~10/?opendiv=2014'>2014-10</a><span class='right_span'>13</span></li>
<li><a href='/blog/cats/2014~09/?opendiv=2014'>2014-09</a><span class='right_span'>7</span></li>
<li><a href='/blog/cats/2014~08/?opendiv=2014'>2014-08</a><span class='right_span'>15</span></li>
<li><a href='/blog/cats/2014~07/?opendiv=2014'>2014-07</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2014~06/?opendiv=2014'>2014-06</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2014~05/?opendiv=2014'>2014-05</a><span class='right_span'>7</span></li>
<li><a href='/blog/cats/2014~04/?opendiv=2014'>2014-04</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2014~03/?opendiv=2014'>2014-03</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2014~02/?opendiv=2014'>2014-02</a><span class='right_span'>11</span></li>
<li><a href='/blog/cats/2014~01/?opendiv=2014'>2014-01</a><span class='right_span'>2</span></li>
</div><li class='catclass'><a href='/blog/cats/2013/'>2013</a><a href='##' onmousedown=showDiv('2013')><span class='exp_style' id='exp_2013'>[+]</span></a><span class='right_span'>(60)</span></li>
<div id='2013' class='catsub'><li><a href='/blog/cats/2013~12/?opendiv=2013'>2013-12</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2013~11/?opendiv=2013'>2013-11</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2013~10/?opendiv=2013'>2013-10</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2013~09/?opendiv=2013'>2013-09</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2013~08/?opendiv=2013'>2013-08</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2013~07/?opendiv=2013'>2013-07</a><span class='right_span'>3</span></li>
<li><a href='/blog/cats/2013~06/?opendiv=2013'>2013-06</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2013~05/?opendiv=2013'>2013-05</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2013~03/?opendiv=2013'>2013-03</a><span class='right_span'>6</span></li>
<li><a href='/blog/cats/2013~02/?opendiv=2013'>2013-02</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2013~01/?opendiv=2013'>2013-01</a><span class='right_span'>1</span></li>
</div><li class='catclass'><a href='/blog/cats/2012/'>2012</a><a href='##' onmousedown=showDiv('2012')><span class='exp_style' id='exp_2012'>[+]</span></a><span class='right_span'>(35)</span></li>
<div id='2012' class='catsub'><li><a href='/blog/cats/2012~12/?opendiv=2012'>2012-12</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2012~11/?opendiv=2012'>2012-11</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2012~10/?opendiv=2012'>2012-10</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2012~08/?opendiv=2012'>2012-08</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2012~05/?opendiv=2012'>2012-05</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2012~04/?opendiv=2012'>2012-04</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2012~03/?opendiv=2012'>2012-03</a><span class='right_span'>6</span></li>
<li><a href='/blog/cats/2012~02/?opendiv=2012'>2012-02</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2012~01/?opendiv=2012'>2012-01</a><span class='right_span'>2</span></li>
</div><li class='catclass'><a href='/blog/cats/2011/'>2011</a><a href='##' onmousedown=showDiv('2011')><span class='exp_style' id='exp_2011'>[+]</span></a><span class='right_span'>(35)</span></li>
<div id='2011' class='catsub'><li><a href='/blog/cats/2011~12/?opendiv=2011'>2011-12</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2011~11/?opendiv=2011'>2011-11</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2011~08/?opendiv=2011'>2011-08</a><span class='right_span'>3</span></li>
<li><a href='/blog/cats/2011~07/?opendiv=2011'>2011-07</a><span class='right_span'>3</span></li>
<li><a href='/blog/cats/2011~06/?opendiv=2011'>2011-06</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2011~05/?opendiv=2011'>2011-05</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2011~04/?opendiv=2011'>2011-04</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2011~03/?opendiv=2011'>2011-03</a><span class='right_span'>11</span></li>
<li><a href='/blog/cats/2011~02/?opendiv=2011'>2011-02</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2011~01/?opendiv=2011'>2011-01</a><span class='right_span'>1</span></li>
</div><li class='catclass'><a href='/blog/cats/2010/'>2010</a><a href='##' onmousedown=showDiv('2010')><span class='exp_style' id='exp_2010'>[+]</span></a><span class='right_span'>(1)</span></li>
<div id='2010' class='catsub'><li><a href='/blog/cats/2010~07/?opendiv=2010'>2010-07</a><span class='right_span'>1</span></li>
</div><li class='catclass'><a href='/blog/cats/2009/'>2009</a><a href='##' onmousedown=showDiv('2009')><span class='exp_style' id='exp_2009'>[+]</span></a><span class='right_span'>(8)</span></li>
<div id='2009' class='catsub'><li><a href='/blog/cats/2009~12/?opendiv=2009'>2009-12</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2009~10/?opendiv=2009'>2009-10</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2009~09/?opendiv=2009'>2009-09</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2009~07/?opendiv=2009'>2009-07</a><span class='right_span'>1</span></li>
</div>
</ul>
</div>
</body>
</html>
</section>

<section>
<h1>Tags</h1>
<ul class="tag-cloud">
<a style="font-size: 131%" href="/tags/gdb/">gdb(6)</a>
<a style="font-size: 100%" href="/tags/hello/">hello(1)</a>
<a style="font-size: 150%" href="/tags/koj/">koj(18)</a>
<a style="font-size: 112%" href="/tags/nvidia/">nvidia(2)</a>
<a style="font-size: 100%" href="/tags/patch/">patch(1)</a>
<a style="font-size: 100%" href="/tags/reg-exp/">reg_exp(1)</a>

</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/02/29/kernel-net-connect/">socket建立连接 sys_connect</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/21/kernel-net-udp-sum/">udp checksum</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/21/system-base-init/">Linux系统启动过程分析</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/12/kernel-base-rtc/">linux 实时时钟（RTC）驱动</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/12/debug-kdump-rtc/">kdump时间错误</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub</h1>
  
  <a href="https://github.com/abcdxyzk">abcdxyzk on GitHub</a>
  
</section>

<section>
<h1>Links</h1>
<ul>
	<li>
		<a href=http://hi.baidu.com/abcdxyzk target=_blank>My blog</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/zhangskd target=_blank>zhangsk</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/justlinux2010 target=_blank>justlinux2010</a>
	</li>
	<li>
		<a href=http://simohayha.iteye.com/ target=_blank>simohayha</a>
	</li>
	<li>
		<a href=http://linux.chinaunix.net/techdoc/net/ target=_blank>技术文档</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/cybertan target=_blank>cybertan</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/newnewman80 target=_blank>newnewman80</a>
	</li>
	<li>
		<a href=http://www.cppblog.com/fwxjj/ target=_blank>fwxjj</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/ustc_dylan target=_blank>ustc_dylan</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/nkguohao target=_blank>nkguohao</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/yusiguyuan target=_blank>yusiguyuan</a>
	</li>
	<li>
		<a href=http://www.oenhan.com/ target=_blank>oenhan</a>
	</li>
	<li>
		<a href=http://blog.csdn.net/bullbat target=_blank>bullbat</a>
	</li>
	<li>
		<a href=http://www.wowotech.net/ target=_blank>wowotech</a>
	</li>
	<li>
		<a href=http://www.lenky.info/ target=_blank>lenky</a>
	</li>
	<li>
		<a href=http://smilejay.com/ target=_blank>smilejay</a>
	</li>
	<li>
		<a href=http://blog.chinaunix.net/uid/10167808.html target=_blank>godbach</a>
	</li>
</ul>
</section>

  
<section id="comment_sidebar">
<h1>Recent Comments</h1>

<script type="text/javascript" src="http://abcdxyzk.disqus.com/recent_comments_widget.js?num_items=5&hide_avatars=0&avatar_size=32&excerpt_length=20"></script><a href="http://disqus.com/">Powered by Disqus</a>

</section>


</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - kk -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <a title="Top" href="#" id="scroll2top" style="position: fixed; height: 50px; bottom: 30px; right: 25px; cursor: pointer; z-index: 9999; display: block; opacity: 1;"><img src="/images/scrollup.png"></a>
  <script src="/javascripts/scroll2top.js"></script>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253604690'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1253604690' type='text/javascript'%3E%3C/script%3E"));</script>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'abcdxyzk';
      
</script>





</body>
</html>
