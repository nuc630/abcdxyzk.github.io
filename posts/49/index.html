
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>kk Blog —— 通用基础</title>

  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="kk Blog —— 通用基础" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/category.js" type="text/javascript"></script>

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">kk Blog —— 通用基础</a></h1>
  
    <h2>学习中......</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
<li>
<form action="/search" method="get">
    <input class="search" name="query" id="query" type="text" placeholder="search...">
    <input id="btnSubmit" value="search" type="submit">
</form>
<script type="text/javascript">
var query = GetRequest("query");
if (query != null) {
	document.getElementById("query").value = query;
}
</script>
</li>
  <li><a href="/atom.xml" rel="subscribe-rss">RSS</a></li>
  
</ul>
  
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/download">Download</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/06/03/compiler-makefile-vars/">Makefile预定义变量、自动变量</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-06-03T15:22:00+08:00'><span class='date'>2013-06-03</span> <span class='time'>15:22:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Makefile中常见自动变量</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>命令格式     含     义
</span><span class='line'>$*        不包含扩展名的目标文件名称
</span><span class='line'>$+        所有的依赖文件，以空格分开，并以出现的先后为序，可能包含重复的依赖文件
</span><span class='line'>$&lt;     第一个依赖文件的名称
</span><span class='line'>$?        所有时间戳比目标文件晚的依赖文件，并以空格分开 
</span><span class='line'>$@        目标文件的完整名称
</span><span class='line'>$^        所有不重复的依赖文件，以空格分开
</span><span class='line'>$%        如果目标是归档成员，则该变量表示目标的归档成员名称</span></code></pre></td></tr></table></div></figure>


<h4>Makefile中常见预定义变量</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>命 令 格 式  含     义
</span><span class='line'>AR                库文件维护程序的名称，默认值为ar
</span><span class='line'>AS                汇编程序的名称，默认值为as
</span><span class='line'>CC                C编译器的名称，默认值为cc
</span><span class='line'>CPP               C预编译器的名称，默认值为$(CC) –E
</span><span class='line'>CXX               C++编译器的名称，默认值为g++
</span><span class='line'>FC                FORTRAN编译器的名称，默认值为f77
</span><span class='line'>RM                文件删除程序的名称，默认值为rm –f
</span><span class='line'>ARFLAGS           库文件维护程序的选项，无默认值
</span><span class='line'>ASFLAGS           汇编程序的选项，无默认值
</span><span class='line'>CFLAGS            C编译器的选项，无默认值
</span><span class='line'>CPPFLAGS      C预编译的选项，无默认值
</span><span class='line'>CXXFLAGS      C++编译器的选项，无默认值
</span><span class='line'>FFLAGS            FORTRAN编译器的选项，无默认值</span></code></pre></td></tr></table></div></figure>


<h5>在Makefile中我们可以通过宏定义来控制源程序的编译。</h5>

<p>只要在Makefile中的CFLAGS中通过选项-D来指定你于定义的宏即可。<br/>
如:<br/>
CFLAGS += -D <strong>KK</strong><br/>
或<br/>
CFLAGS += -D <strong>KK</strong>=<strong>XX</strong></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/06/03/kernel-read-file/">linux内核文件读取</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-06-03T11:32:00+08:00'><span class='date'>2013-06-03</span> <span class='time'>11:32:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// test_file.c
</span><span class='line'>
</span><span class='line'>#include &lt;linux/module.h&gt;
</span><span class='line'>#include &lt;linux/kernel.h&gt;
</span><span class='line'>#include &lt;linux/init.h&gt;
</span><span class='line'>
</span><span class='line'>#include &lt;linux/types.h&gt;
</span><span class='line'>
</span><span class='line'>#include &lt;linux/fs.h&gt;
</span><span class='line'>#include &lt;linux/string.h&gt;
</span><span class='line'>#include &lt;asm/uaccess.h&gt; /* get_fs(),set_fs(),get_ds() */
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>static int __init file_test_init(void)
</span><span class='line'>{
</span><span class='line'>    char *FILE_DIR = "/root/test.txt";
</span><span class='line'>    char *buff = "module read/write test";
</span><span class='line'>    char tmp[100];
</span><span class='line'>    struct file *filp = NULL;
</span><span class='line'>    mm_segment_t old_fs;
</span><span class='line'>    ssize_t ret;
</span><span class='line'>   
</span><span class='line'>    filp = filp_open(FILE_DIR, O_RDWR | O_CREAT, 0644);
</span><span class='line'>   
</span><span class='line'>    if(IS_ERR(filp)) {
</span><span class='line'>        printk("open error...\n");
</span><span class='line'>        return -2;
</span><span class='line'>    }
</span><span class='line'>   
</span><span class='line'>    old_fs = get_fs();
</span><span class='line'>    set_fs(get_ds());
</span><span class='line'>
</span><span class='line'>    filp-&gt;f_op-&gt;write(filp, buff, strlen(buff), &filp-&gt;f_pos);
</span><span class='line'>    filp-&gt;f_op-&gt;llseek(filp, 0, 0);
</span><span class='line'>    ret = filp-&gt;f_op-&gt;read(filp, tmp, strlen(buff), &filp-&gt;f_pos);
</span><span class='line'>
</span><span class='line'>    set_fs(old_fs);
</span><span class='line'>       
</span><span class='line'>    if(ret &gt; 0)
</span><span class='line'>        printk("%s\n", tmp);
</span><span class='line'>    else if(ret == 0)
</span><span class='line'>        printk("read nothing.............\n");
</span><span class='line'>    else {
</span><span class='line'>        printk("read error\n");
</span><span class='line'>        return -1;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    filp_close(filp, NULL);
</span><span class='line'>    return 0;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>static void __exit file_test_exit(void)
</span><span class='line'>{
</span><span class='line'>    printk("file test exit\n");
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>module_init(file_test_init);
</span><span class='line'>module_exit(file_test_exit);
</span><span class='line'>
</span><span class='line'>MODULE_LICENSE("GPL");</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Makefile
</span><span class='line'>
</span><span class='line'>obj-m := test_file.o
</span><span class='line'>
</span><span class='line'>KDIR := /lib/modules/$(uname -r)/build/
</span><span class='line'>PWD := $(shellpwd)
</span><span class='line'>
</span><span class='line'>all:
</span><span class='line'>      make -C $(KDIR) M=$(PWD) modules
</span><span class='line'>clean:
</span><span class='line'>      make -C $(KDIR) M=$(PWD) clean</span></code></pre></td></tr></table></div></figure>


<h4>注意：</h4>

<p>在调用filp->f_op->read和filp->f_op->write等对文件的操作之前，应该先设置FS。<br/>
默认情况下，filp->f_op->read或者filp->f_op->write会对传进来的参数buff进行指针检查。如果不是在用户空间会拒绝访问。因为是在内核模块中，所以buff肯定不在用户空间，所以要增大其寻址范围。</p>

<p>拿filp->f_op->write为例来说明：<br/>
filp->f_op->write最终会调用access_ok ==> range_ok.<br/>
而range_ok会判断访问的地址是否在0 ～ addr_limit之间。如果在，则ok，继续。如果不在，则禁止访问。而内核空间传过来的buff肯定大于addr_limit。所以要set_fs(get_ds())。<br/>
这些函数在asm/uaccess.h中定义。以下是这个头文件中的部分内容：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#define MAKE_MM_SEG(s)   ((mm_segment_t) { (s) })
</span><span class='line'>
</span><span class='line'>#define KERNEL_DS MAKE_MM_SEG(-1UL)
</span><span class='line'>#define USER_DS       MAKE_MM_SEG(PAGE_OFFSET)
</span><span class='line'>
</span><span class='line'>#define get_ds()  (KERNEL_DS)
</span><span class='line'>#define get_fs()  (current_thread_info()-&gt;addr_limit)
</span><span class='line'>#define set_fs(x) (current_thread_info()-&gt;addr_limit = (x))
</span><span class='line'>
</span><span class='line'>#define segment_eq(a, b)  ((a).seg == (b).seg)</span></code></pre></td></tr></table></div></figure>


<p>可以看到set_fs(get_ds())改变了addr_limit的值。这样就使得从模块中传递进去的参数也可以正常使用了。</p>

<p>在写测试模块的时候，要实现的功能是写进去什么，然后读出来放在tmp数组中。但写完了以后filp->f_ops已经在末尾了，这个时候读是什么也 读不到的，如果想要读到数据，则应该改变filp->f-ops的值，这就要用到filp->f_op->llseek函数了。其中的参数需要记下笔记：<br/>
系统调用：<br/>
off_t sys_lseek(unsigned int fd, off_t offset, unsigned int origin)<br/>
offset是偏移量。<br/>
若origin是SEEK_SET(0)，则将该文件的位移量设置为距文件开始处offset 个字节。<br/>
若origin是SEEK_CUR(1)，则将该文件的位移量设置为其当前值加offset, offset可为正或负。<br/>
若origin是SEEK_END(2)，则将该文件的位移量设置为文件长度加offset, offset可为正或负。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/05/28/centos-versions/">RedHat/CentOS发行版本号及内核版本号对照表</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-05-28T15:35:00+08:00'><span class='date'>2013-05-28</span> <span class='time'>15:35:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Redhat 9.0———————————————2.4.20-8
</span><span class='line'>RHEL 3 Update 8————————————2.4.21-47
</span><span class='line'>RHEL 4 ————————————————2.6.9-5
</span><span class='line'>RHEL 4 Update 1————————————2.6.9-11
</span><span class='line'>RHEL 4 Update 2————————————2.6.9-22
</span><span class='line'>RHEL 4 Update 3————————————2.6.9-34
</span><span class='line'>RHEL 4 Update 4————————————2.6.9-42
</span><span class='line'>RHEL 4 Update 5————————————2.6.9-55
</span><span class='line'>RHEL 4 Update 6————————————2.6.9-67
</span><span class='line'>RHEL 4 Update 7————————————2.6.9-78
</span><span class='line'>
</span><span class='line'>CENTOS 5/RHEL 5 ———————————2.6.18-8
</span><span class='line'>CENTOS 5.1/RHEL 5 Update 1——————2.6.18-53
</span><span class='line'>CENTOS 5.2/RHEL 5 Update 2——————2.6.18-92
</span><span class='line'>CENTOS 5.3/RHEL 5 Update 3——————2.6.18-128
</span><span class='line'>CENTOS 5.4/RHEL 5 Update 4——————2.6.18-164
</span><span class='line'>CENTOS 5.5/RHEL 5 Update 5——————2.6.18-194
</span><span class='line'>CENTOS 5.6/RHEL 5 Update 6——————2.6.18-238
</span><span class='line'>CENTOS 5.7/RHEL 5 Update 7——————2.6.18-274
</span><span class='line'>CENTOS 5.8/RHEL 5 Update 8——————2.6.18-308
</span><span class='line'>
</span><span class='line'>CENTOS 6.0/RHEL 6 Update 0——————2.6.32-71
</span><span class='line'>CENTOS 6.1/RHEL 6 Update 1——————2.6.32-131
</span><span class='line'>CENTOS 6.2/RHEL 6 Update 2——————2.6.32-220
</span><span class='line'>CENTOS 6.3/RHEL 6 Update 3——————2.6.32-279
</span><span class='line'>CENTOS 6.4/RHEL 6 Update 4——————2.6.32-358
</span><span class='line'>CENTOS 6.5/RHEL 6 Update 5——————2.6.32-431
</span><span class='line'>CENTOS 6.6/RHEL 6 Update 6——————2.6.32-504
</span><span class='line'>
</span><span class='line'>CENTOS 7.0/RHEL 7 Update 0——————3.10.0-123</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/05/24/debug-kretprobe/">Linux内核kretprobe机制</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-05-24T10:22:00+08:00'><span class='date'>2013-05-24</span> <span class='time'>10:22:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.ibm.com/developerworks/cn/linux/l-cn-systemtap1/index.html">http://www.ibm.com/developerworks/cn/linux/l-cn-systemtap1/index.html</a></p>

<p>  kretprobe也使用了kprobes来实现，当用户调用register_kretprobe()时，kprobe在被探测函数的入口建立 了一个探测点，当执行到探测点时，kprobe保存了被探测函数的返回地址并取代返回地址为一个trampoline的地址，kprobe在初始化时定义 了该trampoline并且为该trampoline注册了一个kprobe,当被探测函数执行它的返回指令时，控制传递到该trampoline，因 此kprobe已经注册的对应于trampoline的处理函数将被执行，而该处理函数会调用用户关联到该kretprobe上的处理函数，处理完毕后， 设置指令寄存器指向已经备份的函数返回地址，因而原来的函数返回被正常执行。</p>

<p>  被探测函数的返回地址保存在类型为 kretprobe_instance的变量中，结构kretprobe的maxactive字段指定了被探测函数可以被同时探测的实例数，函数 register_kretprobe()将预分配指定数量的kretprobe_instance。如果被探测函数是非递归的并且调用时已经保持了自旋 锁（spinlock），那么maxactive为1就足够了；  如果被探测函数是非递归的且运行时是抢占失效的，那么maxactive为NR_CPUS就可以了；如果maxactive被设置为小于等于0,  它被设置到缺省值（如果抢占使能， 即配置了  CONFIG_PREEMPT，缺省值为10和2*NR_CPUS中的最大值，否则缺省值为NR_CPUS）。</p>

<p>  如果 maxactive被设置的太小了，一些探测点的执行可能被丢失，但是不影响系统的正常运行，在结构kretprobe中nmissed字段将记录被丢失 的探测点执行数，它在返回探测点被注册时设置为0，每次当执行探测函数而没有kretprobe_instance可用时，它就加1。</p>

<p><a href="http://hi.baidu.com/lixiang1988/item/8884bc286c9920ceddf69acd">http://hi.baidu.com/lixiang1988/item/8884bc286c9920ceddf69acd</a></p>

<h4>kretprobe的实现</h4>

<p>相关数据结构与函数分析</p>

<h5>1)　struct kretprobe结构</h5>

<p>  该结构是kretprobe实现的基础数据结构，以下是该结构的成员：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct kprobe kp; //该成员是kretprobe内嵌的struct kprobe结构。
</span><span class='line'>kretprobe_handler_t handler;//该成员是调试者定义的回调函数。
</span><span class='line'>int maxactive;//该成员是最多支持的返回地址实例数。
</span><span class='line'>int nmissed;//该成员记录有多少次该函数返回没有被回调函数处理。
</span><span class='line'>struct hlist_head free_instances;
</span><span class='line'>用于链接未使用的返回地址实例，在注册时初始化。
</span><span class='line'>struct hlist_head used_instances;//该成员是正在被使用的返回地址实例链表。</span></code></pre></td></tr></table></div></figure>


<h5>2)　struct kretprobe_instance结构</h5>

<p>  该结构表示一个返回地址实例。因为函数每次被调用的地方不同，这造成了返回地址不同，因此需要为每一次发生的调用记录在这样一个结构里面。以下是该结构的成员：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct hlist_node uflist;
</span><span class='line'>该成员被链接入kretprobe的used_instances或是free_instances链表。
</span><span class='line'>struct kretprobe *rp;//该成员指向所属的kretprobe结构。
</span><span class='line'>kprobe_opcode_t *ret_addr;//该成员用于记录被探测函数正真的返回地址。
</span><span class='line'>struct task_struct *task;//该成员记录当时运行的进程。</span></code></pre></td></tr></table></div></figure>


<h5>3)　pre_handler_kretprobe()函数</h5>

<p>  该函数在kretprobe探测点被执行到后，用于修改被探测函数的返回地址。</p>

<h5>4)　trampoline_handler()函数</h5>

<p>  该函数用于执行调试者定义的回调函数以及把被探测函数的返回地址修改回原来的返回地址。</p>

<h4>kretprobe处理流程分析</h4>

<p>  kretprobe探测方式是基于kprobe实现的又一种内核探测方式，该探测方式主要用于在函数返回时进行探测，获得内核函数的返回值，还可以用于计算函数执行时间等方面。</p>

<h5>1)　kretprobe的注册过程</h5>

<p>  调试者要进行kretprobe调试首先要注册处理，这需要在调试模块中调用register_kretprobe()，下文中称该函数为 kretprobe  注册器。kretprobe注册器对传入的kretprobe结构的中kprobe.pre_handler赋值为 pre_handler_kretprobe()函数，用于在探测点被触发时被调用。接着，kretprobe注册器还会初始化kretprobe的一些 成员，比如分配返回地址实例的空间等操作。最后，kretprobe注册器会利用  kretprobe内嵌的structkprobe结构进行kropbe的注册。自此，kretprobe注册过程就完成了。</p>

<h5>2)　kretprobe探测点的触发过程</h5>

<p>  kretprobe触发是在刚进入被探测函数的第一条汇编指令时发生的，因为 kretprobe注册时把该地址修改位int3指令。<br/>
  此时发生了一次CPU异常处理，这与kprobe探测点被触发相同。但与kprobe处理不同的是，这里并不是运行用户定义的pre_handler函 数，而是执行pre_handler_kretprobe()函数，该函数又会调用arch_prepare_kretprobe()函数。 arch_prepare_kretprobe()函数的主要功能是把被探测函数的返回地址变换为&amp;kretprobe_trampoline所 在的地址，这是一个汇编地址标签。这个标签的地址在kretprobe_trampoline_holder()中用汇编伪指令定义。替换函数返回地址是 kretprobe实现的关键。当被探测函数返回时，返回到&amp;kretprobe_trampoline地址处开始运行。</p>

<p>  接着，在 一些保护现场的处理后，又去调用trampoline_handler()函数。该函数的主要有两个作用，一是根据当前的实例去运行用户定义的调试函数， 也就是kretprobe结构中的handler所指向的函数，二是把返回值设成被探测函数正真的返回地址。最后，在进行一些堆栈的处理后，被探测函数又 返回到了正常执行流程中去。</p>

<p>  以上讨论的就是kretprobe的执行过程，可以看出，该调试方式的关键点在于修改被探测函数的返回地址到kprobes的控制流程中，之后再把返回地址修改到原来的返回地址并使得该函数继续正常执行。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h2 class="entry-title"><a href="/blog/2013/05/24/debug-kprobe-base/">Linux内核kprobe机制</a></h2>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-05-24T10:22:00+08:00'><span class='date'>2013-05-24</span> <span class='time'>10:22:00</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>探测点处理函数在运行时是失效抢占的，依赖于特定的架构，探测点处理函数运行时也可能是中断失效的。</li>
<li><p>因此，对于任何探测点处理函数，不要使用导致睡眠或进程调度的任何内核函数（如尝试获得semaphore)。</p>

<p>Kprobe机制是内核提供的一种调试机制，它提供了一种方法，能够在不修改现有代码的基础上，灵活的跟踪内核函数的执行。它的基本工作原理是：用户指定一个探测点，并把一个用户定义的处理函数关联到该探测点，当内核执行到该探测点时，相应的关联函数被执行，然后继续执行正常的代码路径。</p>

<p>Kprobe提供了三种形式的探测点，一种是最基本的kprobe，能够在指定代码执行前、执行后进行探测，但此时不能访问被探测函数内的相关变量信 息；一种是jprobe，用于探测某一函数的入口，并且能够访问对应的函数参数；一种是kretprobe，用于完成指定函数返回值的探测功能。其中最基 本的就是kprobe机制，jprobe以及kretprobe的实现都依赖于kprobe，但其代码的实现都很巧妙，强烈建议每一个内核爱好者阅读。</p></li>
</ul>


<h4>代码：</h4>

<h5>首先是struct kprobe结构，每一个探测点的基本结构。</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>structkprobe {
</span><span class='line'>    /*用于保存kprobe的全局hash表，以被探测的addr为key*/
</span><span class='line'>    structhlist_node hlist;
</span><span class='line'>
</span><span class='line'>    /* list of kprobes for multi-handler support */
</span><span class='line'>    /*当对同一个探测点存在多个探测函数时，所有的函数挂在这条链上*/
</span><span class='line'>    structlist_head list;
</span><span class='line'>
</span><span class='line'>    /*count the number of times this probe was temporarily disarmed */
</span><span class='line'>    unsigned longnmissed;
</span><span class='line'>
</span><span class='line'>    /* location of the probe point */
</span><span class='line'>    /*被探测的目标地址*/
</span><span class='line'>    kprobe_opcode_t *addr;
</span><span class='line'>
</span><span class='line'>    /* Allow user to indicate symbol name of the probe point */
</span><span class='line'>    /*symblo_name的存在，允许用户指定函数名而非确定的地址*/
</span><span class='line'>    constchar*symbol_name;
</span><span class='line'>
</span><span class='line'>    /* Offset into the symbol */
</span><span class='line'>    /*如果被探测点为函数内部某个指令，需要使用addr + offset的方式*/
</span><span class='line'>    unsigned intoffset;
</span><span class='line'>
</span><span class='line'>    /* Called before addr is executed. */
</span><span class='line'>    /*探测函数，在目标探测点执行之前调用*/
</span><span class='line'>    kprobe_pre_handler_t pre_handler;
</span><span class='line'>
</span><span class='line'>    /* Called after addr is executed, unless... */
</span><span class='line'>    /*探测函数，在目标探测点执行之后调用*/
</span><span class='line'>    kprobe_post_handler_t post_handler;
</span><span class='line'>
</span><span class='line'>    /*
</span><span class='line'>     * ... called if executing addr causes a fault (eg. page fault).
</span><span class='line'>     * Return 1 if it handled fault, otherwise kernel will see it.
</span><span class='line'>     */
</span><span class='line'>    kprobe_fault_handler_t fault_handler;
</span><span class='line'>
</span><span class='line'>    /*
</span><span class='line'>     * ... called if breakpoint trap occurs in probe handler.
</span><span class='line'>     * Return 1 if it handled break, otherwise kernel will see it.
</span><span class='line'>     */
</span><span class='line'>    kprobe_break_handler_t break_handler;
</span><span class='line'>
</span><span class='line'>    /*opcode 以及 ainsn 用于保存被替换的指令码*/
</span><span class='line'>
</span><span class='line'>    /* Saved opcode (which has been replaced with breakpoint) */
</span><span class='line'>    kprobe_opcode_t opcode;
</span><span class='line'>
</span><span class='line'>    /* copy of the original instruction */
</span><span class='line'>    structarch_specific_insn ainsn;
</span><span class='line'>
</span><span class='line'>    /*
</span><span class='line'>     * Indicates various status flags.
</span><span class='line'>     * Protected by kprobe_mutex after this kprobe is registered.
</span><span class='line'>     */
</span><span class='line'>    u32 flags;
</span><span class='line'>};</span></code></pre></td></tr></table></div></figure>


<p>  对于kprobe功能的实现主要利用了内核中的两个功能特性：异常（尤其是int 3），单步执行（EFLAGS中的TF标志）。</p>

<h5>大概的流程：</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> 1）在注册探测点的时候，对被探测函数的指令码进行替换，替换为int 3的指令码；
</span><span class='line'> 2）在执行int 3的异常执行中，通过通知链的方式调用kprobe的异常处理函数；
</span><span class='line'> 3）在kprobe的异常出来函数中，判断是否存在pre_handler钩子，存在则执行；
</span><span class='line'> 4）执行完后，准备进入单步调试，通过设置EFLAGS中的TF标志位，并且把异常返回的地址修改为保存的原指令码；
</span><span class='line'> 5）代码返回，执行原有指令，执行结束后触发单步异常；
</span><span class='line'> 6）在单步异常的处理中，清除单步标志，执行post_handler流程，并最终返回；</span></code></pre></td></tr></table></div></figure>


<p>  下面又进入代码时间，首先看一下kprobe模块的初始化代码，初始化代码主要做了两件事：标记出哪些代码是不能被探测的，这些代码属于kprobe实现的关键代码；注册通知链到die_notifier，用于接收异常通知。</p>

<h5>初始化代码位于kernel/kprobes.c中</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>staticint__init init_kprobes(void)
</span><span class='line'>{
</span><span class='line'>    inti,err =0;
</span><span class='line'>        ....
</span><span class='line'>
</span><span class='line'>     /*kprobe_blacklist中保存的是kprobe实现的关键代码路径，这些函数不应该被kprobe探测*/
</span><span class='line'>    /*
</span><span class='line'>     * Lookup and populate the kprobe_blacklist.
</span><span class='line'>     *
</span><span class='line'>     * Unlike the kretprobe blacklist, we'll need to determine
</span><span class='line'>     * the range of addresses that belong to the said functions,
</span><span class='line'>     * since a kprobe need not necessarily be at the beginning
</span><span class='line'>     * of a function.
</span><span class='line'>     */
</span><span class='line'>    for(kb =kprobe_blacklist;kb-&gt;name!=NULL;kb++){
</span><span class='line'>        kprobe_lookup_name(kb-&gt;name,addr);
</span><span class='line'>        if(!addr)
</span><span class='line'>            continue;
</span><span class='line'>
</span><span class='line'>        kb-&gt;start_addr =(unsigned long)addr;
</span><span class='line'>        symbol_name =kallsyms_lookup(kb-&gt;start_addr,
</span><span class='line'>                &size,&offset,&modname,namebuf);
</span><span class='line'>        if(!symbol_name)
</span><span class='line'>            kb-&gt;range =0;
</span><span class='line'>        else
</span><span class='line'>            kb-&gt;range =size;
</span><span class='line'>    }
</span><span class='line'>        ....
</span><span class='line'>    if(!err)
</span><span class='line'>        /*注册通知链到die_notifier，用于接收int 3的异常信息*/
</span><span class='line'>        err =register_die_notifier(&kprobe_exceptions_nb);
</span><span class='line'>         ....
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>其中的通知链：</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>staticstructnotifier_block kprobe_exceptions_nb ={
</span><span class='line'>    .notifier_call =kprobe_exceptions_notify,
</span><span class='line'>    /*优先级最高，保证最先执行*/
</span><span class='line'>    .priority =0x7fffffff /* we need to be notified first */
</span><span class='line'>};</span></code></pre></td></tr></table></div></figure>


<h6>kprobe的注册流程register_kprobe。</h6>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int__kprobes register_kprobe(structkprobe *p)
</span><span class='line'>{
</span><span class='line'>    intret =0;
</span><span class='line'>    structkprobe *old_p;
</span><span class='line'>    structmodule *probed_mod;
</span><span class='line'>    kprobe_opcode_t *addr;
</span><span class='line'>
</span><span class='line'>    /*获取被探测点的地址，指定了symbol_name，则从kallsyms中获取；指定了offset，则返回addr + offset*/
</span><span class='line'>    addr =kprobe_addr(p);
</span><span class='line'>    if(!addr)
</span><span class='line'>        return-EINVAL;
</span><span class='line'>    p-&gt;addr =addr;
</span><span class='line'>
</span><span class='line'>    /*判断同一个kprobe是否被重复注册*/
</span><span class='line'>    ret =check_kprobe_rereg(p);
</span><span class='line'>    if(ret)
</span><span class='line'>        returnret;
</span><span class='line'>
</span><span class='line'>    jump_label_lock();
</span><span class='line'>    preempt_disable();
</span><span class='line'>    /*判断被注册的函数是否位于内核的代码段内，或位于不能探测的kprobe实现路径中*/
</span><span class='line'>    if(!kernel_text_address((unsigned long)p-&gt;addr)||
</span><span class='line'>        in_kprobes_functions((unsigned long)p-&gt;addr)||
</span><span class='line'>        ftrace_text_reserved(p-&gt;addr,p-&gt;addr)||
</span><span class='line'>        jump_label_text_reserved(p-&gt;addr,p-&gt;addr))
</span><span class='line'>        gotofail_with_jump_label;
</span><span class='line'>
</span><span class='line'>    /* User can pass only KPROBE_FLAG_DISABLED to register_kprobe */
</span><span class='line'>    p-&gt;flags&=KPROBE_FLAG_DISABLED;
</span><span class='line'>
</span><span class='line'>    /*
</span><span class='line'>     * Check if are we probing a module.
</span><span class='line'>     */
</span><span class='line'>    /*判断被探测的地址是否属于某一个模块，并且位于模块的text section内*/
</span><span class='line'>    probed_mod =__module_text_address((unsigned long)p-&gt;addr);
</span><span class='line'>    if(probed_mod){
</span><span class='line'>        /*如果被探测的为模块地址，首先要增加模块的引用计数*/
</span><span class='line'>        /*
</span><span class='line'>         * We must hold a refcount of the probed module while updating
</span><span class='line'>         * its code to prohibit unexpected unloading.
</span><span class='line'>         */
</span><span class='line'>        if(unlikely(!try_module_get(probed_mod)))
</span><span class='line'>            gotofail_with_jump_label;
</span><span class='line'>
</span><span class='line'>        /*
</span><span class='line'>         * If the module freed .init.text, we couldn't insert
</span><span class='line'>         * kprobes in there.
</span><span class='line'>         */
</span><span class='line'>        /*如果被探测的地址位于模块的init地址段内，但该段代码区间已被释放，则直接退出*/
</span><span class='line'>        if(within_module_init((unsigned long)p-&gt;addr,probed_mod)&&
</span><span class='line'>            probed_mod-&gt;state!=MODULE_STATE_COMING){
</span><span class='line'>            module_put(probed_mod);
</span><span class='line'>            gotofail_with_jump_label;
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    preempt_enable();
</span><span class='line'>    jump_label_unlock();
</span><span class='line'>
</span><span class='line'>    p-&gt;nmissed =0;
</span><span class='line'>    INIT_LIST_HEAD(&p-&gt;list);
</span><span class='line'>    mutex_lock(&kprobe_mutex);
</span><span class='line'>
</span><span class='line'>    jump_label_lock();/* needed to call jump_label_text_reserved() */
</span><span class='line'>
</span><span class='line'>    get_online_cpus();    /* For avoiding text_mutex deadlock. */
</span><span class='line'>    mutex_lock(&text_mutex);
</span><span class='line'>
</span><span class='line'>    /*判断在同一个探测点是否已经注册了其他的探测函数*/
</span><span class='line'>    old_p =get_kprobe(p-&gt;addr);
</span><span class='line'>    if(old_p){
</span><span class='line'>        /* Since this may unoptimize old_p, locking text_mutex. */
</span><span class='line'>        /*如果已经存在注册过的kprobe，则将探测点的函数修改为aggr_pre_handler，并将所有的handler挂载到其链表上，由其负责所有handler函数的执行*/
</span><span class='line'>        ret =register_aggr_kprobe(old_p,p);
</span><span class='line'>        gotoout;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    /* 分配特定的内存地址用于保存原有的指令
</span><span class='line'>     * 按照内核注释，被分配的地址必须must be on special executable page on x86.
</span><span class='line'>     * 该地址被保存在kprobe-&gt;ainsn.insn
</span><span class='line'>     */
</span><span class='line'>    ret =arch_prepare_kprobe(p);
</span><span class='line'>    if(ret)
</span><span class='line'>        gotoout;
</span><span class='line'>
</span><span class='line'>    /*将kprobe加入到相应的hash表内*/
</span><span class='line'>    INIT_HLIST_NODE(&p-&gt;hlist);
</span><span class='line'>    hlist_add_head_rcu(&p-&gt;hlist,
</span><span class='line'>               &kprobe_table[hash_ptr(p-&gt;addr,KPROBE_HASH_BITS)]);
</span><span class='line'>
</span><span class='line'>    if(!kprobes_all_disarmed &&!kprobe_disabled(p))
</span><span class='line'>/*将探测点的指令码修改为int 3指令*/
</span><span class='line'>        __arm_kprobe(p);
</span><span class='line'>
</span><span class='line'>    /* Try to optimize kprobe */
</span><span class='line'>    try_to_optimize_kprobe(p);
</span><span class='line'>
</span><span class='line'>out:
</span><span class='line'>    mutex_unlock(&text_mutex);
</span><span class='line'>    put_online_cpus();
</span><span class='line'>    jump_label_unlock();
</span><span class='line'>    mutex_unlock(&kprobe_mutex);
</span><span class='line'>
</span><span class='line'>    if(probed_mod)
</span><span class='line'>        module_put(probed_mod);
</span><span class='line'>
</span><span class='line'>    returnret;
</span><span class='line'>
</span><span class='line'>fail_with_jump_label:
</span><span class='line'>    preempt_enable();
</span><span class='line'>    jump_label_unlock();
</span><span class='line'>    return-EINVAL;</span></code></pre></td></tr></table></div></figure>


<h5>注册完毕，就开始kprobe的执行流程了。对于该探测点，由于其起始指令已经被修改为int3，因此在执行到该地址时，必然会触发3号中断向量的处理流程do_int3.</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* May run on IST stack. */
</span><span class='line'>dotraplinkage void__kprobes do_int3(structpt_regs *regs,longerror_code)
</span><span class='line'>{
</span><span class='line'>#ifdef CONFIG_KGDB_LOW_LEVEL_TRAP
</span><span class='line'>    if(kgdb_ll_trap(DIE_INT3,"int3",regs,error_code,3,SIGTRAP)
</span><span class='line'>            ==NOTIFY_STOP)
</span><span class='line'>        return;
</span><span class='line'>#endif /* CONFIG_KGDB_LOW_LEVEL_TRAP */
</span><span class='line'>#ifdef CONFIG_KPROBES
</span><span class='line'>    /*在这里以DIE_INT3，通知kprobe注册的通知链*/
</span><span class='line'>    if(notify_die(DIE_INT3,"int3",regs,error_code,3,SIGTRAP)
</span><span class='line'>            ==NOTIFY_STOP)
</span><span class='line'>        return;
</span><span class='line'>#else
</span><span class='line'>    if(notify_die(DIE_TRAP,"int3",regs,error_code,3,SIGTRAP)
</span><span class='line'>            ==NOTIFY_STOP)
</span><span class='line'>        return;
</span><span class='line'>#endif
</span><span class='line'>
</span><span class='line'>    preempt_conditional_sti(regs);
</span><span class='line'>    do_trap(3,SIGTRAP,"int3",regs,error_code,NULL);
</span><span class='line'>    preempt_conditional_cli(regs);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>在do_int3中触发kprobe注册的通知链函数，kprobe_exceptions_notify。由于kprobe以及jprobe等机制的处 理核心都在此函数内，这里只针对kprobe的流程进行分析：进入函数的原因是DIE_INT3,并且是第一次进入该函数。</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int__kprobes kprobe_exceptions_notify(structnotifier_block *self,
</span><span class='line'>                       unsigned longval,void*data)
</span><span class='line'>{
</span><span class='line'>    structdie_args *args =data;
</span><span class='line'>    intret =NOTIFY_DONE;
</span><span class='line'>
</span><span class='line'>    if(args-&gt;regs &&user_mode_vm(args-&gt;regs))
</span><span class='line'>        returnret;
</span><span class='line'>
</span><span class='line'>    switch(val){
</span><span class='line'>    caseDIE_INT3:
</span><span class='line'>/*对于kprobe，进入kprobe_handle*/
</span><span class='line'>        if(kprobe_handler(args-&gt;regs))
</span><span class='line'>            ret =NOTIFY_STOP;
</span><span class='line'>        break;
</span><span class='line'>    caseDIE_DEBUG:
</span><span class='line'>        if(post_kprobe_handler(args-&gt;regs)){
</span><span class='line'>            /*
</span><span class='line'>             * Reset the BS bit in dr6 (pointed by args-&gt;err) to
</span><span class='line'>             * denote completion of processing
</span><span class='line'>             */
</span><span class='line'>            (*(unsigned long*)ERR_PTR(args-&gt;err))&=~DR_STEP;
</span><span class='line'>            ret =NOTIFY_STOP;
</span><span class='line'>        }
</span><span class='line'>        break;
</span><span class='line'>    caseDIE_GPF:
</span><span class='line'>        /*
</span><span class='line'>         * To be potentially processing a kprobe fault and to
</span><span class='line'>         * trust the result from kprobe_running(), we have
</span><span class='line'>         * be non-preemptible.
</span><span class='line'>         */
</span><span class='line'>        if(!preemptible()&&kprobe_running()&&
</span><span class='line'>            kprobe_fault_handler(args-&gt;regs,args-&gt;trapnr))
</span><span class='line'>            ret =NOTIFY_STOP;
</span><span class='line'>        break;
</span><span class='line'>    default:
</span><span class='line'>        break;
</span><span class='line'>    }
</span><span class='line'>    returnret;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>staticint__kprobes kprobe_handler(structpt_regs *regs)
</span><span class='line'>{
</span><span class='line'>    kprobe_opcode_t *addr;
</span><span class='line'>    structkprobe *p;
</span><span class='line'>    structkprobe_ctlblk *kcb;
</span><span class='line'>
</span><span class='line'>    /*对于int 3中断，其被Intel定义为Trap，那么异常发生时EIP寄存器内指向的为异常指令的后一条指令*/
</span><span class='line'>    addr =(kprobe_opcode_t *)(regs-&gt;ip -sizeof(kprobe_opcode_t));
</span><span class='line'>    /*
</span><span class='line'>     * We don't want to be preempted for the entire
</span><span class='line'>     * duration of kprobe processing. We conditionally
</span><span class='line'>     * re-enable preemption at the end of this function,
</span><span class='line'>     * and also in reenter_kprobe() and setup_singlestep().
</span><span class='line'>     */
</span><span class='line'>    preempt_disable();
</span><span class='line'>
</span><span class='line'>    kcb =get_kprobe_ctlblk();
</span><span class='line'>    /*获取addr对应的kprobe*/
</span><span class='line'>    p =get_kprobe(addr);
</span><span class='line'>
</span><span class='line'>    if(p){
</span><span class='line'>/*如果异常的进入是由kprobe导致，则进入reenter_kprobe(jprobe需要，到时候分析)*/
</span><span class='line'>        if(kprobe_running()){
</span><span class='line'>            if(reenter_kprobe(p,regs,kcb))
</span><span class='line'>                return1;
</span><span class='line'>        }else{
</span><span class='line'>            set_current_kprobe(p,regs,kcb);
</span><span class='line'>            kcb-&gt;kprobe_status =KPROBE_HIT_ACTIVE;
</span><span class='line'>
</span><span class='line'>            /*
</span><span class='line'>             * If we have no pre-handler or it returned 0, we
</span><span class='line'>             * continue with normal processing.  If we have a
</span><span class='line'>             * pre-handler and it returned non-zero, it prepped
</span><span class='line'>             * for calling the break_handler below on re-entry
</span><span class='line'>             * for jprobe processing, so get out doing nothing
</span><span class='line'>             * more here.
</span><span class='line'>             */
</span><span class='line'>    /*执行在此地址上挂载的pre_handle函数*/
</span><span class='line'>            if(!p-&gt;pre_handler ||!p-&gt;pre_handler(p,regs))
</span><span class='line'>/*设置单步调试模式，为post_handle函数的执行做准备*/
</span><span class='line'>                setup_singlestep(p,regs,kcb,0);
</span><span class='line'>            return1;
</span><span class='line'>        }
</span><span class='line'>    }elseif(*addr !=BREAKPOINT_INSTRUCTION){
</span><span class='line'>        /*
</span><span class='line'>         * The breakpoint instruction was removed right
</span><span class='line'>         * after we hit it.  Another cpu has removed
</span><span class='line'>         * either a probepoint or a debugger breakpoint
</span><span class='line'>         * at this address.  In either case, no further
</span><span class='line'>         * handling of this interrupt is appropriate.
</span><span class='line'>         * Back up over the (now missing) int3 and run
</span><span class='line'>         * the original instruction.
</span><span class='line'>         */
</span><span class='line'>        regs-&gt;ip =(unsigned long)addr;
</span><span class='line'>        preempt_enable_no_resched();
</span><span class='line'>        return1;
</span><span class='line'>    }elseif(kprobe_running()){
</span><span class='line'>        p =__this_cpu_read(current_kprobe);
</span><span class='line'>        if(p-&gt;break_handler &&p-&gt;break_handler(p,regs)){
</span><span class='line'>            setup_singlestep(p,regs,kcb,0);
</span><span class='line'>            return1;
</span><span class='line'>        }
</span><span class='line'>    }/* else: not a kprobe fault; let the kernel handle it */
</span><span class='line'>
</span><span class='line'>    preempt_enable_no_resched();
</span><span class='line'>    return0;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>staticvoid__kprobes setup_singlestep(structkprobe *p,structpt_regs *regs,
</span><span class='line'>                       structkprobe_ctlblk *kcb,intreenter)
</span><span class='line'>{
</span><span class='line'>    if(setup_detour_execution(p,regs,reenter))
</span><span class='line'>        return;
</span><span class='line'>
</span><span class='line'>#if!defined(CONFIG_PREEMPT)
</span><span class='line'>    if(p-&gt;ainsn.boostable ==1 &&!p-&gt;post_handler){
</span><span class='line'>        /* Boost up -- we can execute copied instructions directly */
</span><span class='line'>        if(!reenter)
</span><span class='line'>            reset_current_kprobe();
</span><span class='line'>        /*
</span><span class='line'>         * Reentering boosted probe doesn't reset current_kprobe,
</span><span class='line'>         * nor set current_kprobe, because it doesn't use single
</span><span class='line'>         * stepping.
</span><span class='line'>         */
</span><span class='line'>        regs-&gt;ip =(unsigned long)p-&gt;ainsn.insn;
</span><span class='line'>        preempt_enable_no_resched();
</span><span class='line'>        return;
</span><span class='line'>    }
</span><span class='line'>#endif
</span><span class='line'>    /*jprobe*/
</span><span class='line'>    if(reenter){
</span><span class='line'>        save_previous_kprobe(kcb);
</span><span class='line'>        set_current_kprobe(p,regs,kcb);
</span><span class='line'>        kcb-&gt;kprobe_status =KPROBE_REENTER;
</span><span class='line'>    }else
</span><span class='line'>        kcb-&gt;kprobe_status =KPROBE_HIT_SS;
</span><span class='line'>    /* Prepare real single stepping */
</span><span class='line'>    /*准备单步模式，设置EFLAGS的TF标志位，清楚IF标志位(禁止中断)*/
</span><span class='line'>    clear_btf();
</span><span class='line'>    regs-&gt;flags|=X86_EFLAGS_TF;
</span><span class='line'>    regs-&gt;flags&=~X86_EFLAGS_IF;
</span><span class='line'>    /* single step inline if the instruction is an int3 */
</span><span class='line'>    if(p-&gt;opcode ==BREAKPOINT_INSTRUCTION)
</span><span class='line'>        regs-&gt;ip =(unsigned long)p-&gt;addr;
</span><span class='line'>    else
</span><span class='line'>/*设置异常返回的指令为保存的被探测点的指令*/
</span><span class='line'>        regs-&gt;ip =(unsigned long)p-&gt;ainsn.insn;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>对应kprobe,pre_handle的执行就结束了，按照代码，程序开始执行保存的被探测点的指令，由于开启了单步调试模式，执行完指令后会继续触发异常，这次的是do_debug异常处理流程。</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dotraplinkage void__kprobes do_debug(structpt_regs *regs,longerror_code)
</span><span class='line'>{
</span><span class='line'>    ....
</span><span class='line'>
</span><span class='line'>    /*在do_debug中，以DIE_DEBUG再一次触发kprobe的通知链*/
</span><span class='line'>    if(notify_die(DIE_DEBUG,"debug",regs,PTR_ERR(&dr6),error_code,
</span><span class='line'>                            SIGTRAP)==NOTIFY_STOP)
</span><span class='line'>        return;
</span><span class='line'>   
</span><span class='line'>    ....
</span><span class='line'>    return;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>/*对于kprobe_exceptions_notify，其DIE_DEBUG处理流程*/
</span><span class='line'>caseDIE_DEBUG:
</span><span class='line'>        if(post_kprobe_handler(args-&gt;regs)){
</span><span class='line'>            /*
</span><span class='line'>             * Reset the BS bit in dr6 (pointed by args-&gt;err) to
</span><span class='line'>             * denote completion of processing
</span><span class='line'>             */
</span><span class='line'>            (*(unsigned long*)ERR_PTR(args-&gt;err))&=~DR_STEP;
</span><span class='line'>            ret =NOTIFY_STOP;
</span><span class='line'>        }
</span><span class='line'>        break;
</span><span class='line'>
</span><span class='line'>staticint__kprobes post_kprobe_handler(structpt_regs *regs)
</span><span class='line'>{
</span><span class='line'>    structkprobe *cur =kprobe_running();
</span><span class='line'>    structkprobe_ctlblk *kcb =get_kprobe_ctlblk();
</span><span class='line'>
</span><span class='line'>    if(!cur)
</span><span class='line'>        return0;
</span><span class='line'>
</span><span class='line'>    /*设置异常返回的EIP为下一条需要执行的指令*/
</span><span class='line'>    resume_execution(cur,regs,kcb);
</span><span class='line'>    /*恢复异常执行前的EFLAGS*/
</span><span class='line'>    regs-&gt;flags|=kcb-&gt;kprobe_saved_flags;
</span><span class='line'>
</span><span class='line'>    /*执行post_handler函数*/
</span><span class='line'>    if((kcb-&gt;kprobe_status !=KPROBE_REENTER)&&cur-&gt;post_handler){
</span><span class='line'>        kcb-&gt;kprobe_status =KPROBE_HIT_SSDONE;
</span><span class='line'>        cur-&gt;post_handler(cur,regs,0);
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    /* Restore back the original saved kprobes variables and continue. */
</span><span class='line'>    if(kcb-&gt;kprobe_status ==KPROBE_REENTER){
</span><span class='line'>        restore_previous_kprobe(kcb);
</span><span class='line'>        gotoout;
</span><span class='line'>    }
</span><span class='line'>    reset_current_kprobe();
</span><span class='line'>out:
</span><span class='line'>    preempt_enable_no_resched();
</span><span class='line'>
</span><span class='line'>    /*
</span><span class='line'>     * if somebody else is singlestepping across a probe point, flags
</span><span class='line'>     * will have TF set, in which case, continue the remaining processing
</span><span class='line'>     * of do_debug, as if this is not a probe hit.
</span><span class='line'>     */
</span><span class='line'>    if(regs-&gt;flags&X86_EFLAGS_TF)
</span><span class='line'>        return0;
</span><span class='line'>
</span><span class='line'>    return1;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>至此，一个典型的kprobe的流程已经执行完毕了。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/50">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/48">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<h1>Categories</h1>
<head>
</head>
<body>
<div id="menu">
<ul>
<li class='catclass'><a href='/blog/cats/language/'>language</a><a href='##' onmousedown=showDiv('language') id='aexp_language'><span class='exp_style' id='exp_language'>[+]</span></a><span class='right_span'>(38)</span></li>
<div id='language' class='catsub'><li><a href='/blog/cats/language~c/?opendiv=language'>c</a><a href='##' onmousedown=showDiv('language~c') id='aexp_language~c'><span class='exp_style' id='exp_language~c'>[+]</span></a><span class='right_span'>21</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('language~c')) document.getElementById('aexp_language~c').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/language~java/?opendiv=language'>java</a><a href='##' onmousedown=showDiv('language~java') id='aexp_language~java'><span class='exp_style' id='exp_language~java'>[+]</span></a><span class='right_span'>11</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('language~java')) document.getElementById('aexp_language~java').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/language~web/?opendiv=language'>web</a><a href='##' onmousedown=showDiv('language~web') id='aexp_language~web'><span class='exp_style' id='exp_language~web'>[+]</span></a><span class='right_span'>6</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('language')) document.getElementById('aexp_language').style.visibility = 'hidden';
if (!document.getElementById('language~web')) document.getElementById('aexp_language~web').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/compiler/'>compiler</a><a href='##' onmousedown=showDiv('compiler') id='aexp_compiler'><span class='exp_style' id='exp_compiler'>[+]</span></a><span class='right_span'>(14)</span></li>
<div id='compiler' class='catsub'><li><a href='/blog/cats/compiler~base/?opendiv=compiler'>base</a><a href='##' onmousedown=showDiv('compiler~base') id='aexp_compiler~base'><span class='exp_style' id='exp_compiler~base'>[+]</span></a><span class='right_span'>10</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('compiler~base')) document.getElementById('aexp_compiler~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/compiler~make/?opendiv=compiler'>make</a><a href='##' onmousedown=showDiv('compiler~make') id='aexp_compiler~make'><span class='exp_style' id='exp_compiler~make'>[+]</span></a><span class='right_span'>4</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('compiler')) document.getElementById('aexp_compiler').style.visibility = 'hidden';
if (!document.getElementById('compiler~make')) document.getElementById('aexp_compiler~make').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/assembly/'>assembly</a><a href='##' onmousedown=showDiv('assembly') id='aexp_assembly'><span class='exp_style' id='exp_assembly'>[+]</span></a><span class='right_span'>(14)</span></li>
<div id='assembly' class='catsub'><li><a href='/blog/cats/assembly~arm/?opendiv=assembly'>arm</a><a href='##' onmousedown=showDiv('assembly~arm') id='aexp_assembly~arm'><span class='exp_style' id='exp_assembly~arm'>[+]</span></a><span class='right_span'>2</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('assembly~arm')) document.getElementById('aexp_assembly~arm').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/assembly~base/?opendiv=assembly'>base</a><a href='##' onmousedown=showDiv('assembly~base') id='aexp_assembly~base'><span class='exp_style' id='exp_assembly~base'>[+]</span></a><span class='right_span'>12</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('assembly')) document.getElementById('aexp_assembly').style.visibility = 'hidden';
if (!document.getElementById('assembly~base')) document.getElementById('aexp_assembly~base').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/tools/'>tools</a><a href='##' onmousedown=showDiv('tools') id='aexp_tools'><span class='exp_style' id='exp_tools'>[+]</span></a><span class='right_span'>(38)</span></li>
<div id='tools' class='catsub'><li><a href='/blog/cats/tools~base/?opendiv=tools'>base</a><a href='##' onmousedown=showDiv('tools~base') id='aexp_tools~base'><span class='exp_style' id='exp_tools~base'>[+]</span></a><span class='right_span'>13</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~base')) document.getElementById('aexp_tools~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~ci/?opendiv=tools'>ci</a><a href='##' onmousedown=showDiv('tools~ci') id='aexp_tools~ci'><span class='exp_style' id='exp_tools~ci'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~ci')) document.getElementById('aexp_tools~ci').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~command/?opendiv=tools'>command</a><a href='##' onmousedown=showDiv('tools~command') id='aexp_tools~command'><span class='exp_style' id='exp_tools~command'>[+]</span></a><span class='right_span'>7</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~command')) document.getElementById('aexp_tools~command').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~git/?opendiv=tools'>git</a><a href='##' onmousedown=showDiv('tools~git') id='aexp_tools~git'><span class='exp_style' id='exp_tools~git'>[+]</span></a><span class='right_span'>6</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~git')) document.getElementById('aexp_tools~git').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~mysql/?opendiv=tools'>mysql</a><a href='##' onmousedown=showDiv('tools~mysql') id='aexp_tools~mysql'><span class='exp_style' id='exp_tools~mysql'>[+]</span></a><span class='right_span'>6</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('tools~mysql')) document.getElementById('aexp_tools~mysql').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/tools~ssh/?opendiv=tools'>ssh</a><a href='##' onmousedown=showDiv('tools~ssh') id='aexp_tools~ssh'><span class='exp_style' id='exp_tools~ssh'>[+]</span></a><span class='right_span'>3</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('tools')) document.getElementById('aexp_tools').style.visibility = 'hidden';
if (!document.getElementById('tools~ssh')) document.getElementById('aexp_tools~ssh').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/system/'>system</a><a href='##' onmousedown=showDiv('system') id='aexp_system'><span class='exp_style' id='exp_system'>[+]</span></a><span class='right_span'>(25)</span></li>
<div id='system' class='catsub'><li><a href='/blog/cats/system~base/?opendiv=system'>base</a><a href='##' onmousedown=showDiv('system~base') id='aexp_system~base'><span class='exp_style' id='exp_system~base'>[+]</span></a><span class='right_span'>12</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~base')) document.getElementById('aexp_system~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~centos/?opendiv=system'>centos</a><a href='##' onmousedown=showDiv('system~centos') id='aexp_system~centos'><span class='exp_style' id='exp_system~centos'>[+]</span></a><span class='right_span'>5</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('system~centos')) document.getElementById('aexp_system~centos').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/system~ubuntu/?opendiv=system'>ubuntu</a><a href='##' onmousedown=showDiv('system~ubuntu') id='aexp_system~ubuntu'><span class='exp_style' id='exp_system~ubuntu'>[+]</span></a><span class='right_span'>8</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('system')) document.getElementById('aexp_system').style.visibility = 'hidden';
if (!document.getElementById('system~ubuntu')) document.getElementById('aexp_system~ubuntu').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/kernel/'>kernel</a><a href='##' onmousedown=showDiv('kernel') id='aexp_kernel'><span class='exp_style' id='exp_kernel'>[+]</span></a><span class='right_span'>(99)</span></li>
<div id='kernel' class='catsub'><li><a href='/blog/cats/kernel~base/?opendiv=kernel'>base</a><a href='##' onmousedown=showDiv('kernel~base') id='aexp_kernel~base'><span class='exp_style' id='exp_kernel~base'>[+]</span></a><span class='right_span'>13</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~base')) document.getElementById('aexp_kernel~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~irq/?opendiv=kernel'>irq</a><a href='##' onmousedown=showDiv('kernel~irq') id='aexp_kernel~irq'><span class='exp_style' id='exp_kernel~irq'>[+]</span></a><span class='right_span'>10</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~irq')) document.getElementById('aexp_kernel~irq').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~kexec/?opendiv=kernel'>kexec</a><a href='##' onmousedown=showDiv('kernel~kexec') id='aexp_kernel~kexec'><span class='exp_style' id='exp_kernel~kexec'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~kexec')) document.getElementById('aexp_kernel~kexec').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~mm/?opendiv=kernel'>mm</a><a href='##' onmousedown=showDiv('kernel~mm') id='aexp_kernel~mm'><span class='exp_style' id='exp_kernel~mm'>[+]</span></a><span class='right_span'>17</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~mm')) document.getElementById('aexp_kernel~mm').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~net/?opendiv=kernel'>net</a><a href='##' onmousedown=showDiv('kernel~net') id='aexp_kernel~net'><span class='exp_style' id='exp_kernel~net'>[+]</span></a><span class='right_span'>44</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel~net')) document.getElementById('aexp_kernel~net').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/kernel~sched/?opendiv=kernel'>sched</a><a href='##' onmousedown=showDiv('kernel~sched') id='aexp_kernel~sched'><span class='exp_style' id='exp_kernel~sched'>[+]</span></a><span class='right_span'>14</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('kernel')) document.getElementById('aexp_kernel').style.visibility = 'hidden';
if (!document.getElementById('kernel~sched')) document.getElementById('aexp_kernel~sched').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/android/'>android</a><a href='##' onmousedown=showDiv('android') id='aexp_android'><span class='exp_style' id='exp_android'>[+]</span></a><span class='right_span'>(17)</span></li>
<div id='android' class='catsub'><li><a href='/blog/cats/android~base/?opendiv=android'>base</a><a href='##' onmousedown=showDiv('android~base') id='aexp_android~base'><span class='exp_style' id='exp_android~base'>[+]</span></a><span class='right_span'>8</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~base')) document.getElementById('aexp_android~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~i9507v/?opendiv=android'>i9507v</a><a href='##' onmousedown=showDiv('android~i9507v') id='aexp_android~i9507v'><span class='exp_style' id='exp_android~i9507v'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~i9507v')) document.getElementById('aexp_android~i9507v').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~me722/?opendiv=android'>me722</a><a href='##' onmousedown=showDiv('android~me722') id='aexp_android~me722'><span class='exp_style' id='exp_android~me722'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~me722')) document.getElementById('aexp_android~me722').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~nx403a/?opendiv=android'>nx403a</a><a href='##' onmousedown=showDiv('android~nx403a') id='aexp_android~nx403a'><span class='exp_style' id='exp_android~nx403a'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('android~nx403a')) document.getElementById('aexp_android~nx403a').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/android~s5830/?opendiv=android'>s5830</a><a href='##' onmousedown=showDiv('android~s5830') id='aexp_android~s5830'><span class='exp_style' id='exp_android~s5830'>[+]</span></a><span class='right_span'>2</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('android')) document.getElementById('aexp_android').style.visibility = 'hidden';
if (!document.getElementById('android~s5830')) document.getElementById('aexp_android~s5830').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/debug/'>debug</a><a href='##' onmousedown=showDiv('debug') id='aexp_debug'><span class='exp_style' id='exp_debug'>[+]</span></a><span class='right_span'>(56)</span></li>
<div id='debug' class='catsub'><li><a href='/blog/cats/debug~base/?opendiv=debug'>base</a><a href='##' onmousedown=showDiv('debug~base') id='aexp_debug~base'><span class='exp_style' id='exp_debug~base'>[+]</span></a><span class='right_span'>16</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~base')) document.getElementById('aexp_debug~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~dwarf/?opendiv=debug'>dwarf</a><a href='##' onmousedown=showDiv('debug~dwarf') id='aexp_debug~dwarf'><span class='exp_style' id='exp_debug~dwarf'>[+]</span></a><span class='right_span'>4</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~dwarf')) document.getElementById('aexp_debug~dwarf').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~gdb/?opendiv=debug'>gdb</a><a href='##' onmousedown=showDiv('debug~gdb') id='aexp_debug~gdb'><span class='exp_style' id='exp_debug~gdb'>[+]</span></a><span class='right_span'>6</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~gdb')) document.getElementById('aexp_debug~gdb').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~kdump,-crash/?opendiv=debug'>kdump、crash</a><a href='##' onmousedown=showDiv('debug~kdump、crash') id='aexp_debug~kdump、crash'><span class='exp_style' id='exp_debug~kdump、crash'>[+]</span></a><span class='right_span'>7</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~kdump、crash')) document.getElementById('aexp_debug~kdump、crash').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~kgdb/?opendiv=debug'>kgdb</a><a href='##' onmousedown=showDiv('debug~kgdb') id='aexp_debug~kgdb'><span class='exp_style' id='exp_debug~kgdb'>[+]</span></a><span class='right_span'>3</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~kgdb')) document.getElementById('aexp_debug~kgdb').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~kprobe/?opendiv=debug'>kprobe</a><a href='##' onmousedown=showDiv('debug~kprobe') id='aexp_debug~kprobe'><span class='exp_style' id='exp_debug~kprobe'>[+]</span></a><span class='right_span'>4</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~kprobe')) document.getElementById('aexp_debug~kprobe').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~mark/?opendiv=debug'>mark</a><a href='##' onmousedown=showDiv('debug~mark') id='aexp_debug~mark'><span class='exp_style' id='exp_debug~mark'>[+]</span></a><span class='right_span'>13</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('debug~mark')) document.getElementById('aexp_debug~mark').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/debug~systemtap/?opendiv=debug'>systemtap</a><a href='##' onmousedown=showDiv('debug~systemtap') id='aexp_debug~systemtap'><span class='exp_style' id='exp_debug~systemtap'>[+]</span></a><span class='right_span'>3</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('debug')) document.getElementById('aexp_debug').style.visibility = 'hidden';
if (!document.getElementById('debug~systemtap')) document.getElementById('aexp_debug~systemtap').style.visibility = 'hidden';
</script>
<li><div style="background:#DDD; height:0.3em;"></div></li><li class='catclass'><a href='/blog/cats/algorithm/'>algorithm</a><a href='##' onmousedown=showDiv('algorithm') id='aexp_algorithm'><span class='exp_style' id='exp_algorithm'>[+]</span></a><span class='right_span'>(26)</span></li>
<div id='algorithm' class='catsub'><li><a href='/blog/cats/algorithm~base/?opendiv=algorithm'>base</a><a href='##' onmousedown=showDiv('algorithm~base') id='aexp_algorithm~base'><span class='exp_style' id='exp_algorithm~base'>[+]</span></a><span class='right_span'>19</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm~base')) document.getElementById('aexp_algorithm~base').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/algorithm~dp/?opendiv=algorithm'>dp</a><a href='##' onmousedown=showDiv('algorithm~dp') id='aexp_algorithm~dp'><span class='exp_style' id='exp_algorithm~dp'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm~dp')) document.getElementById('aexp_algorithm~dp').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/algorithm~ds/?opendiv=algorithm'>ds</a><a href='##' onmousedown=showDiv('algorithm~ds') id='aexp_algorithm~ds'><span class='exp_style' id='exp_algorithm~ds'>[+]</span></a><span class='right_span'>4</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm~ds')) document.getElementById('aexp_algorithm~ds').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/algorithm~tc/?opendiv=algorithm'>tc</a><a href='##' onmousedown=showDiv('algorithm~tc') id='aexp_algorithm~tc'><span class='exp_style' id='exp_algorithm~tc'>[+]</span></a><span class='right_span'>2</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('algorithm')) document.getElementById('aexp_algorithm').style.visibility = 'hidden';
if (!document.getElementById('algorithm~tc')) document.getElementById('aexp_algorithm~tc').style.visibility = 'hidden';
</script>
<li class='catclass'><a href='/blog/cats/blog/'>blog</a><a href='##' onmousedown=showDiv('blog') id='aexp_blog'><span class='exp_style' id='exp_blog'>[+]</span></a><span class='right_span'>(11)</span></li>
<div id='blog' class='catsub'><li><a href='/blog/cats/blog~hello/?opendiv=blog'>hello</a><a href='##' onmousedown=showDiv('blog~hello') id='aexp_blog~hello'><span class='exp_style' id='exp_blog~hello'>[+]</span></a><span class='right_span'>1</span></li>
<div id='blog~hello' class='catsub2'><li><a href='/blog/cats/blog~hello~hi/?opendiv=blog~hello'>hi</a><span class='right_span'>1</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~hello')) document.getElementById('aexp_blog~hello').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~jekyll/?opendiv=blog'>jekyll</a><a href='##' onmousedown=showDiv('blog~jekyll') id='aexp_blog~jekyll'><span class='exp_style' id='exp_blog~jekyll'>[+]</span></a><span class='right_span'>2</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~jekyll')) document.getElementById('aexp_blog~jekyll').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~markdown/?opendiv=blog'>markdown</a><a href='##' onmousedown=showDiv('blog~markdown') id='aexp_blog~markdown'><span class='exp_style' id='exp_blog~markdown'>[+]</span></a><span class='right_span'>1</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~markdown')) document.getElementById('aexp_blog~markdown').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~octopress/?opendiv=blog'>octopress</a><a href='##' onmousedown=showDiv('blog~octopress') id='aexp_blog~octopress'><span class='exp_style' id='exp_blog~octopress'>[+]</span></a><span class='right_span'>5</span></li>
<script language='javascript' type='text/javascript'>
if (!document.getElementById('blog~octopress')) document.getElementById('aexp_blog~octopress').style.visibility = 'hidden';
</script>
<li><a href='/blog/cats/blog~ruby/?opendiv=blog'>ruby</a><a href='##' onmousedown=showDiv('blog~ruby') id='aexp_blog~ruby'><span class='exp_style' id='exp_blog~ruby'>[+]</span></a><span class='right_span'>2</span></li>
</div><script language='javascript' type='text/javascript'>
if (!document.getElementById('blog')) document.getElementById('aexp_blog').style.visibility = 'hidden';
if (!document.getElementById('blog~ruby')) document.getElementById('aexp_blog~ruby').style.visibility = 'hidden';
</script>

</ul>
</div>
</body>
</html>
</section>

<section>
<h1>Date Categories</h1>
<head>
</head>
<body>
<div id="menu">
<ul>
<li class='catclass'><a href='/blog/cats/2015/'>2015</a><a href='##' onmousedown=showDiv('2015')><span class='exp_style' id='exp_2015'>[+]</span></a><span class='right_span'>(87)</span></li>
<div id='2015' class='catsub'><li><a href='/blog/cats/2015~05/?opendiv=2015'>2015-05</a><span class='right_span'>15</span></li>
<li><a href='/blog/cats/2015~04/?opendiv=2015'>2015-04</a><span class='right_span'>23</span></li>
<li><a href='/blog/cats/2015~03/?opendiv=2015'>2015-03</a><span class='right_span'>19</span></li>
<li><a href='/blog/cats/2015~02/?opendiv=2015'>2015-02</a><span class='right_span'>11</span></li>
<li><a href='/blog/cats/2015~01/?opendiv=2015'>2015-01</a><span class='right_span'>19</span></li>
</div><li class='catclass'><a href='/blog/cats/2014/'>2014</a><a href='##' onmousedown=showDiv('2014')><span class='exp_style' id='exp_2014'>[+]</span></a><span class='right_span'>(112)</span></li>
<div id='2014' class='catsub'><li><a href='/blog/cats/2014~12/?opendiv=2014'>2014-12</a><span class='right_span'>21</span></li>
<li><a href='/blog/cats/2014~11/?opendiv=2014'>2014-11</a><span class='right_span'>19</span></li>
<li><a href='/blog/cats/2014~10/?opendiv=2014'>2014-10</a><span class='right_span'>13</span></li>
<li><a href='/blog/cats/2014~09/?opendiv=2014'>2014-09</a><span class='right_span'>7</span></li>
<li><a href='/blog/cats/2014~08/?opendiv=2014'>2014-08</a><span class='right_span'>15</span></li>
<li><a href='/blog/cats/2014~07/?opendiv=2014'>2014-07</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2014~06/?opendiv=2014'>2014-06</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2014~05/?opendiv=2014'>2014-05</a><span class='right_span'>7</span></li>
<li><a href='/blog/cats/2014~04/?opendiv=2014'>2014-04</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2014~03/?opendiv=2014'>2014-03</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2014~02/?opendiv=2014'>2014-02</a><span class='right_span'>11</span></li>
<li><a href='/blog/cats/2014~01/?opendiv=2014'>2014-01</a><span class='right_span'>2</span></li>
</div><li class='catclass'><a href='/blog/cats/2013/'>2013</a><a href='##' onmousedown=showDiv('2013')><span class='exp_style' id='exp_2013'>[+]</span></a><span class='right_span'>(60)</span></li>
<div id='2013' class='catsub'><li><a href='/blog/cats/2013~12/?opendiv=2013'>2013-12</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2013~11/?opendiv=2013'>2013-11</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2013~10/?opendiv=2013'>2013-10</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2013~09/?opendiv=2013'>2013-09</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2013~08/?opendiv=2013'>2013-08</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2013~07/?opendiv=2013'>2013-07</a><span class='right_span'>3</span></li>
<li><a href='/blog/cats/2013~06/?opendiv=2013'>2013-06</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2013~05/?opendiv=2013'>2013-05</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2013~03/?opendiv=2013'>2013-03</a><span class='right_span'>6</span></li>
<li><a href='/blog/cats/2013~02/?opendiv=2013'>2013-02</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2013~01/?opendiv=2013'>2013-01</a><span class='right_span'>1</span></li>
</div><li class='catclass'><a href='/blog/cats/2012/'>2012</a><a href='##' onmousedown=showDiv('2012')><span class='exp_style' id='exp_2012'>[+]</span></a><span class='right_span'>(35)</span></li>
<div id='2012' class='catsub'><li><a href='/blog/cats/2012~12/?opendiv=2012'>2012-12</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2012~11/?opendiv=2012'>2012-11</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2012~10/?opendiv=2012'>2012-10</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2012~08/?opendiv=2012'>2012-08</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2012~05/?opendiv=2012'>2012-05</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2012~04/?opendiv=2012'>2012-04</a><span class='right_span'>9</span></li>
<li><a href='/blog/cats/2012~03/?opendiv=2012'>2012-03</a><span class='right_span'>6</span></li>
<li><a href='/blog/cats/2012~02/?opendiv=2012'>2012-02</a><span class='right_span'>5</span></li>
<li><a href='/blog/cats/2012~01/?opendiv=2012'>2012-01</a><span class='right_span'>2</span></li>
</div><li class='catclass'><a href='/blog/cats/2011/'>2011</a><a href='##' onmousedown=showDiv('2011')><span class='exp_style' id='exp_2011'>[+]</span></a><span class='right_span'>(35)</span></li>
<div id='2011' class='catsub'><li><a href='/blog/cats/2011~12/?opendiv=2011'>2011-12</a><span class='right_span'>8</span></li>
<li><a href='/blog/cats/2011~11/?opendiv=2011'>2011-11</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2011~08/?opendiv=2011'>2011-08</a><span class='right_span'>3</span></li>
<li><a href='/blog/cats/2011~07/?opendiv=2011'>2011-07</a><span class='right_span'>3</span></li>
<li><a href='/blog/cats/2011~06/?opendiv=2011'>2011-06</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2011~05/?opendiv=2011'>2011-05</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2011~04/?opendiv=2011'>2011-04</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2011~03/?opendiv=2011'>2011-03</a><span class='right_span'>11</span></li>
<li><a href='/blog/cats/2011~02/?opendiv=2011'>2011-02</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2011~01/?opendiv=2011'>2011-01</a><span class='right_span'>1</span></li>
</div><li class='catclass'><a href='/blog/cats/2010/'>2010</a><a href='##' onmousedown=showDiv('2010')><span class='exp_style' id='exp_2010'>[+]</span></a><span class='right_span'>(1)</span></li>
<div id='2010' class='catsub'><li><a href='/blog/cats/2010~07/?opendiv=2010'>2010-07</a><span class='right_span'>1</span></li>
</div><li class='catclass'><a href='/blog/cats/2009/'>2009</a><a href='##' onmousedown=showDiv('2009')><span class='exp_style' id='exp_2009'>[+]</span></a><span class='right_span'>(8)</span></li>
<div id='2009' class='catsub'><li><a href='/blog/cats/2009~12/?opendiv=2009'>2009-12</a><span class='right_span'>1</span></li>
<li><a href='/blog/cats/2009~10/?opendiv=2009'>2009-10</a><span class='right_span'>4</span></li>
<li><a href='/blog/cats/2009~09/?opendiv=2009'>2009-09</a><span class='right_span'>2</span></li>
<li><a href='/blog/cats/2009~07/?opendiv=2009'>2009-07</a><span class='right_span'>1</span></li>
</div>
</ul>
</div>
</body>
</html>
</section>

<section>
<h1>Tags</h1>
<ul class="tag-cloud">
<a style="font-size: 131%" href="/tags/gdb/">gdb(6)</a>
<a style="font-size: 100%" href="/tags/hello/">hello(1)</a>
<a style="font-size: 150%" href="/tags/koj/">koj(18)</a>
<a style="font-size: 112%" href="/tags/nvidia/">nvidia(2)</a>
<a style="font-size: 100%" href="/tags/patch/">patch(1)</a>
<a style="font-size: 100%" href="/tags/reg-exp/">reg_exp(1)</a>

</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/05/15/kernel-net-ipv6/">ipv6初始化和处理流程分析</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/15/kernel-net-tcp_urg/">TCP的URG标志和内核实现</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/15/debug-mark-tcp_collapse-bug/">tcp_collapse do not copy headers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/11/kernel-net-tcp_queue/">tcp三个接收队列</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/11/debug-mark-tcp_read_sock_bug/">tcp_read_sock BUG</a>
      </li>
    
  </ul>
</section>
<section>
<h1>Links</h1>
<ul>
	<li>
		<a href=http://hi.baidu.com/abcdxyzk target=_blank>My blog</a>
	</li>
</ul>
</section>

  
<section id="comment_sidebar">
<h1>Recent Comments</h1>

<script type="text/javascript" src="http://abcdxyzk.disqus.com/recent_comments_widget.js?num_items=5&hide_avatars=0&avatar_size=32&excerpt_length=20"></script><a href="http://disqus.com/">Powered by Disqus</a>

</section>


</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - kk -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <a title="Top" href="#" id="scroll2top" style="position: fixed; height: 50px; bottom: 30px; right: 25px; cursor: pointer; z-index: 9999; display: block; opacity: 1;"><img src="/images/scrollup.png"></a>
  <script src="/javascripts/scroll2top.js"></script>
<!--  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253604690'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1253604690' type='text/javascript'%3E%3C/script%3E"));</script> -->
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'abcdxyzk';
      
</script>





</body>
</html>
